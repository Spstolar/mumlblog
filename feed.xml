<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.0.0">Jekyll</generator><link href="http://simonstolarczyk.com/feed.xml" rel="self" type="application/atom+xml" /><link href="http://simonstolarczyk.com/" rel="alternate" type="text/html" /><updated>2020-09-30T20:20:05-05:00</updated><id>http://simonstolarczyk.com/feed.xml</id><title type="html">Musical Machine Learning</title><subtitle>A blog where I think about music, machine learning, and other things that interest me.</subtitle><entry><title type="html">Reading in a Wave File</title><link href="http://simonstolarczyk.com/jupyter/2020/09/30/Reading_in_a_Wave_File.html" rel="alternate" type="text/html" title="Reading in a Wave File" /><published>2020-09-30T00:00:00-05:00</published><updated>2020-09-30T00:00:00-05:00</updated><id>http://simonstolarczyk.com/jupyter/2020/09/30/Reading_in_a_Wave_File</id><content type="html" xml:base="http://simonstolarczyk.com/jupyter/2020/09/30/Reading_in_a_Wave_File.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-09-30-Reading_in_a_Wave_File.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;First I created the simple sound file in &lt;a href=&quot;https://www.reaper.fm/&quot;&gt;Reaper&lt;/a&gt;. I could not use the base WAV (Waveform Audio File Format) file because it stores it as 24-bit data which does not work with the scipy &lt;code&gt;wavfile&lt;/code&gt; method. However, choosing 32-bit data is a simple option when you render the sound.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The sound I created was simple 2 seconds of a sine wave at around C4. Zooming in to a 0.045 second window we can see the wave in Reaper. A simple peak-to-peak measure was 0.00375 seconds long which gives a frequency around 267 herz. Since this was a C4, which is typically 262 it is not too far off.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;To read the file a quick search brought up &lt;a href=&quot;https://docs.scipy.org/doc/scipy/reference/generated/scipy.io.wavfile.read.html&quot;&gt;the &lt;code&gt;wavfile&lt;/code&gt; method from scipy&lt;/a&gt;. I basically follow the example provided there on my sound.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;scipy.io&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;wavfile&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pathlib&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Path&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sounds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;q&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;simple_c4.wav&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;q&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;WindowsPath(&amp;#39;sounds/simple_c4.wav&amp;#39;)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sample_rate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;wavfile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;q&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;c:\python37\lib\site-packages\scipy\io\wavfile.py:273: WavFileWarning: Chunk (non-data) not understood, skipping it.
  WavFileWarning)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sample_rate&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;44100&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;array([[ 0.0000000e+00,  0.0000000e+00],
       [ 0.0000000e+00,  0.0000000e+00],
       [-3.8028106e-06, -3.8028106e-06],
       ...,
       [-6.6743125e-03, -6.6743125e-03],
       [-4.4752425e-03, -4.4752425e-03],
       [-2.2473824e-03, -2.2473824e-03]], dtype=float32)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;(88200, 2)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Since the recording is 2 seconds long and the sample rate is 44100, there are 88200 samples total, as expected. This is a list of channel lists. So, the stereo data is recorded for each sample.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;length&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sample_rate&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;length&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;2.0&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;linspace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;In this case the channels are the same, so just plotting the first one:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Time [s]&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Amplitude&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Too much info for this tiny graph! Let's look at just one second and then zoom in more.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;span_length&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;//&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;span_length&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;44100&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;span_length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;span_length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Time [s]&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Amplitude&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;span_length&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;//&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;span_length&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;4410&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;span_length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;span_length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Time [s]&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Amplitude&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;span_length&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;//&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;span_length&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;441&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;start_sample&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;500&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;start_sample&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;start_sample&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;span_length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;start_sample&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;start_sample&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;span_length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Time [s]&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Amplitude&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAY0AAAEKCAYAAADuEgmxAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDMuMC4yLCBodHRwOi8vbWF0cGxvdGxpYi5vcmcvOIA7rQAAIABJREFUeJzt3Xl8XHd56P/PMxrt0miXrM2SZcuL5N0idkJWspCUJYSt0LKW/oDbS0t/be990V9baKGX0t4CLZfeppT+LmErOySEJCSEkAQSG8uOF428L7Kkkax9Rvs23/vHzDjCkeWRNDPnnJnn/XrNy1qOzjzHM3Oe7/4VYwxKKaVUNFxWB6CUUso5NGkopZSKmiYNpZRSUdOkoZRSKmqaNJRSSkVNk4ZSSqmoadJQSikVNU0aSimloqZJQymlVNTcVgcQa6Wlpaa+vt7qMJRSylEOHTo0YIwpu95xSZc06uvraW1ttToMpZRyFBHpiOY4bZ5SSikVNU0aSimloqZJQymlVNQ0aSillIqaJg2llFJR06ShlFIqapo0lFJKRS3p5mko+5udD/KLU/2c6g2Qn5XOHZvKWVuSY3VYahV6/VP87MRlhsdnWF+exx2bysnOSLM6LBUHmjRUQrVeHOLPf3CcM31jV372N+LlXfvq+IvXbSHTrTcaJwkGDZ976jQPPnuOuaC58vPy/Ez+8W07uHXjdScYK4fRpKES5pmTfXzoa4co92Ty4Lt2c/umcvpHp/ny8+d56MUOLg1N8OC79pCVronDCWbng/zpd47yyFEfb95dzX+9YwM1RdkcvDDMpx5t5/1fOcjfvXkbb2+ptTpUFUPap6ES4qVLw3zoa4fYuCaPn/zhLdy7tZKs9DRqi3P4m/u38ndv3sazp/v50+8cxRhz/RMqy/3to+08ctTHx+7bzOfevpP1ZXlkutO4ubGU7/2XG7lpfQl//oPj/OrsgNWhqhjSpKHibnRqlo9+6whl+Zl8/QN7KchJf8Ux77xhLf/9tZv5yfEevvnrSxZEqZbj0WM+Hnqxgw/cvI4P37b+Fb/Pz0rnX9+1h4bSXD7yzcNcDkxZEKWKB00aKu4+/dhJuoYn+Od37KQwJ+Oax33o1gZu3VjGpx5txzcymcAI1XL4J2b5+MNedtYW8rH7Nl/zuLxMNw++ew/jM/N86tH2BEao4kmThoqrdl+Abx28xPtuWkdLffGSx7pcwqcf2Iox8JnHTyYoQrVcn3vqFCMTM3z6gW2kpy19C1lflsd/vX0Djx7r4fkz/QmKUMWTJg0VV59+7AQF2el89M7GqI6vKcrhQ7c28MhRH4c6huMcnVqu8/1jfG1/B7+7t46mKk9Uf/Ph2xtYW5zD3z9xUvurkoAmDRU3By8O8cuzA3zkjg2L9mNcy4dvX09xbgZf/PmZOEanVuJfnjlHhtvFR++KrhAAkOlO4w9fs4G27gBPn+iLY3QqETRpqLh58BfnKM7N4Hf31i3r73Iy3Pzeq+t55lQ/Xp8/TtGp5eocmuBHR7p55w1rKc3LXNbfPrCrmrqSHP7p6dNa23A4TRoqLk71jvL0yT7ee2P9imYGv/vGevIy3fzbs+fjEJ1aif/45QVcAh+8tWHZf+tOc/GhW9fT1h2gVZsdHU2ThoqLr754kUy3i/fcuLxaRkRBdjpvb6nl8bYe+kenYxucWraJmTm+f6iL39pWSWVB9orO8aZdVXiy3HzlhYuxDU4llCYNFXPj03M8fMTH67ZXUpR77SG21/M7e9cyO2/47qHOGEanVuKRIz5Gp+d4976VFQIg1Oz426+q5Ym2Xnr9Om/DqTRpqJh79JiPsek5fueGtas6z4byPPY1FPPNA5cIBrUd3EpfP9DB5jX57KkrWtV53rWvjvmg4fuHu2IUmUo0TRoq5r51sJONFXmrvsFAaKZ41/Ak+y8MxiAytRKnekdp6w7w26+qRURWda66klxuqC/m+4e7tEPcoTRpqJjqHJrgpUsjPLCrZtU3GIB7mtaQm5HGwy/5YhCdWokfvtRNmkt4w46qmJzvzburOd8/ztEuHRnnRJo0VEz95HgPAK/fXhmT82VnpPHarWt47HgPU7PzMTmnil4waHj4SDe3NpYue5jttfzW9koy3S5+oE1UjmRp0hCRe0XklIicFZGPLXHcW0XEiEhLIuNTy/fjoz521hZSWxy7TZXetLOa0ek5njmpE8MS7eDFIXr8U7xpV3XMzunJSufOLeU83tarfVUOZFnSEJE04F+A+4Am4J0i0rTIcfnAHwEHEhuhWq7z/WN4fYGY1TIiblpfQkluBo+39cb0vOr6nvD2kuF2cdeWipie97XNa+gfnealTp2z4TRW1jRuAM4aY84bY2aAbwH3L3Lcp4B/AHSMns09eqwHEXj99ti0fUe401zcuaWcZ072MTMXjOm51bUZY3jSe5lbNpSSmxnb/dpes7mcjDQXT2hBwHGsTBrVwMIB+F3hn10hIruAWmPMo4kMTK3MY8d7eFVdMWsKsmJ+7nua1jA6PccBHUWVMF5fgO6RSV7bvCbm587PSufVG0p4wturo6gcxsqksdjQmivvHhFxAZ8H/vS6JxL5oIi0ikhrf78uv2yFruEJTvaOck9zbJsxIm5uLCU7PY0nvZfjcn71Sk+2X8YlcOeW8ric/96ta+gcmqS9JxCX86v4sDJpdAELNw+uARaOq8wHtgK/EJGLwD7gkcU6w40xXzLGtBhjWsrKdCN7K0Q6qe/YHJ8bTFZ6GrduLOWp9staMk2QJ729tNQXUxKjUVNXu2tLBS6Bn2oTlaNYmTQOAo0isk5EMoB3AI9EfmmM8RtjSo0x9caYemA/8EZjTKs14aql/PxkH3UlOTSU5sbtOe5pWkNvYIrj3Tq+P94uDYZrjk3xqTkClORl8qr6Yp5s19qjk1iWNIwxc8BHgJ8CJ4DvGGO8IvJJEXmjVXGp5ZucmeeFc4Pcsak8JhP6ruU1m8tJcwlP6U0m7n5+MvR/fHcckwaEaqYne0d1D3EHsXSehjHmMWPMRmPMemPM/wj/7OPGmEcWOfZ2rWXY0wvnBpieC8at7TuiKDeDXbWFPHda+63i7bkzA9SX5FBXEr+aI8CtjaHmZH1NnUNnhKtV+/nJPnIy0rhh3dJ7gMfCLY1lHOv2Mzw+E/fnSlXTc/O8eG6QWzfGv39wS2U+ZfmZPKtJwzE0aahVMcbwi1P93LyhlEz38jdbWq5bNpZiDPzq3EDcnytVHeoYZnJ2nlsa4580RIRbG8v45dkB5nV2uCNo0lCrcnFwgu6RSW5JQKkUYHt1AflZbn55RpNGvDx/ZgC3S7hxfUlCnu+2TWWMTMxyrGskIc+nVkeThlqVX50N3bxfnaAbjDvNxavXl/L8mQEdehsnz53uZ3ddEXkxngV+LbdsKEUEnjutBQEn0KShVuXFc4NUFmSxLo5Dba92y8ZSukcmOT8wnrDnTBUDY9N4fQFuS1DNEUIDHLZXF/DcGe3XcAJNGmrFgkHDC+cGuGl9aVyH2l4tMuLmee08jblIzfGWxtKEPu/NjaUc7RxhfHouoc+rlk+ThlqxE70BhidmuSlBTVMRtcU51JXk8Muzug5VrO0/P4gny01zVUFCn3dfQwlzQcOhDl311u40aagVeyF80371hsSWSgH2rivm4MUh3Y8hxvafH+KGdcWkuRJXcwTYU1eE2yXsP68FAbvTpKFW7IVzAzSU5cZlVdvr2buuBP/kLKcujyb8uZNVX2CKCwPj7F2X2JojQE6Gmx21hZo0HECThlqRufkgv74wlPCmqYi9DaGJhAf0JhMz+y8MAS//3ybavoZijnX5tV/D5jRpqBVp7wkwPjNvSakUoKYoh+rCbA6Eb3Rq9Q6cHyQ/001TpceS59d+DWfQpKFWpPVi6IPdUl9kWQx71xXz6wtDOl8jRvafH6Slvgh3mjW3Be3XcAZNGmpFWjuGqCnKprIg27IY9jYUMzg+w9m+MctiSBb9o9Oc6x9nb4M1NUfQfg2n0KShls0Yw8GLw7TUWVfLAK40jWkT1er9OtKfkYBFJ5dyw7pQv8bU7Lylcahr06Shlu3S0AT9o9O01Ft7g6kryaHCk6lJIwYOXhwiOz2NrdWJnZ9xtT1ri5gLGo516UZbdqVJQy1bpD/jVRYnDRGhpb6Yw9pxumqHLw2zo7aAdIv6MyJ2h2uv2hluX5o01LK1dgzhyXLTWJ5ndSjsXltE98ik7vy2CpMz87T7AuyxuLkRoDg3g4bSXE0aNqZJQy3bwYvDtNQX40rwrOHF7F5bCKC1jVU41jXCXNCwe631SQNCtY3Dl4Z1VJxNadJQyzIcHq1k5VDbhZqrCshwuzh8SZPGSh2+FNrHYpdNksaeuiKGxmfoGJywOhS1CE0aalkizQYtddb2Z0RkuF1sqy64cuNTy3f40jANpbkU52ZYHQrAlRqPNlHZkyYNtSwHO4bISHOxvcbaUTYL7V5byPFuPzNzQatDcRxjDIc7hm1TywBoLM8jP9PNIa092pImDbUshy4Os7XaQ1Z6/PcDj9butUXMzAXx+nSY5nJdGppgcHyG3XWFVodyhcsl7Kor0n4qm9KkoaI2Ox/keLffVqVS0GGaqxH5P7PDyKmF9qwt4tTlUQJTs1aHoq6iSUNF7VTvKNNzQXbW2qdUClDhyaK6MJuXtF9j2Q5fGiYv001jeb7VofyGPXVFGANH9DW1HU0aKmpHOkMfYLslDXh5mKZankMdI+ysLUz4pkvXs6O2AJdo7dGONGmoqB3tHKEkN4OaIusWKbyW3WsL6fFP0eOftDoUxxibnuNUb+BK856d5Gels7EiXwsCNqRJQ0XtSOcIO2oLEbFXqRReHqZ5uEObM6J1rHOEoIFda+1Xc4RQjfZ4t18n+dmMJg0VldGpWc72j7Gjxp43mKYqDxluF0c6tWQaraPhRQHt+ppurylkZGKWS0M6yc9ONGmoqBzv8mMM7LRpqTQ9zUVTpefKjVBd37GuEWqLs20zqe9qkblAkb40ZQ+aNFRUjnSFPrg7bDSp72o7agrwdvuZD2pzRjSOdfnZbtNaBsCmNflkul26TLrNaNJQUTlyaYT6khwKc+xZKoVQc8b4zDzn+3Unv+sZGJume2TS1oWA9DQXzVUejnVpTSManUMTCZnXYmnSEJF7ReSUiJwVkY8t8vs/EZF2ETkmIk+LSJ0VcSo42jViy6G2C0WaM7SJ6voiN2I71zQgFF9bd4C5eV0i5nr+6uE23v7gi3F/HsuShoikAf8C3Ac0Ae8UkaarDnsJaDHGbAe+B/xDYqNUAL3+KS4Hptlh86TRUJZHbkYax7Vkel3HuvyIYPlOfdezo7aAydl5zmrtcUnGhHY73JaA19PKmsYNwFljzHljzAzwLeD+hQcYY54xxkSGTuwHahIco4IrI5LsnjTSXMLW6gKtaUThWJefDWV55GW6rQ5lSZGa0LFOfU2X0jU8ydD4DNsT8Bm1MmlUA50Lvu8K/+xaPgA8vtgvROSDItIqIq39/f0xDFFBqLnH7RKaKj1Wh3JdO2oLae8J6Iq3SwiVSkds3zQFsK4kl/xMN0e19rik492R4dPJXdNYbIbYosNeRORdQAvwPxf7vTHmS8aYFmNMS1lZWQxDVABt3X42VuTbamXba9lWXcDMXJDTl0etDsW2fP4pBsZm2FFr76YpCK14u722QEdQXcfx7lDBbtOa+K8hZmXS6AJqF3xfA/iuPkhE7gL+AnijMWY6QbGpMGMM7b4AzVX2r2XAyxPV9CZzbcfC8x4S0f4dC9trCjnRE2Bqdt7qUGzL6wuwsSKfTHf8C3ZWJo2DQKOIrBORDOAdwCMLDxCRXcC/EUoYfRbEmPIuB6YZHJ9xTNKoLc6mMCddh2kuIdLcuMUBzY0QanKZCxpO9ASsDsWWQgU7f8I+o5YlDWPMHPAR4KfACeA7xhiviHxSRN4YPux/AnnAd0XkiIg8co3TqThpC7eVNjukVCoibKvW5oylHOsaYXOlM5obYUFnuL6mi+obnWZgLHEFO0uHThhjHgMeu+pnH1/w9V0JD0r9Bq8vgAiOKZVCqInqX589x9TsvGNujIkSDBqOd/t5w44qq0OJWmVBFiW5GVcKMOo3RXasTFTBTmeEqyV5fX7qS3JtPzRzoe01BcwHDV6fNmdcrXN4gtGpOcf0Z0Co9thcXaCv5zV4uxNbsNOkoZbk9QVockh/RkRkwlq77hn+CpEbr1P6qCK2Vnk4fXmU6TntDL+a1xdIaMFOk4a6ppGJGbpHJh13g6ksyKI4N4O2bi2ZXs3r85PmEjZW2Gt71+vZWh3qDD/dqzPDr+bt8Se0YKdJQ11Te7hUurXKOU0ZEG7OqPLg7dGaxtW8vgCN5XmO6+uJFFzatPb4G/yTs3QOJbZgp0lDXZNTmzIAmqsKONU7qjPDr+LE5kaAtcU55Ge5r3T6qpD2K5/RxBXsNGmoa/L6/KzxZFGSl2l1KMvWXOVhdt5wpk9nhkf0jU7RPzrtiOVgrhapPWqT42+6MnJKaxrKDrwOmgl+tUhnuFdvMldYUSqNpa1VBZzo0WXSF/L6AlR4MilNYMFOk4Za1OTMPOf6xxybNOqKc8jL1OaMhSLNjU5sngJorvYwPRfkXP+41aHYhtfnT3ghQJPGApMz80zMzFkdhi2c7A0QNNDk0FKpK7wqb5uO7b+i3Regtjibgux0q0NZkciADC0IhEzNznOufzzhBTtNGmHdI5M0f+IJHjnyijUTU1KbgzvBI5qqPJzoCeie4WFen5/mSmcWAiC0yVZWukv7NcJO9o4yHzSaNKxS6ckiN8Ots07D2n1+CrLTqSnKtjqUFdtaXcDEzDwXBrQ5Y3RqlouDE44uBKRdqT1qTQMWdoLbrHlKRHJE5K9E5N/D3zeKyOvjH1piucKrfrbrSppAeGhmpQeRxbY9cYbIDVKbM+BET2gUWXO1c5MGhG6Q7b4AQa094vUFLCnYRVPT+D/ANHBj+Psu4G/jFpGFtDkjZHY+yMneUUeXSgE2lOeR4XZp7ZGXl1RpcnDzFMDWag9j03NcGpq4/sFJzqqCXTRJY70x5h+AWQBjzCSL77rneE1VHiZm5ukYTO3mjHP9Y8zMBa8MW3Wq9DQXm9fka02D0A2mJDeDCo/z5twsFGmKSfUmqrn5ICd7rBkSH03SmBGRbMJbsYrIekI1j6QTeQFSvYkqMrfB6TUNCN1k2roDGJPatcfITHAnNzcCbKzIJz1NUr4z/PzAONNzQUuaG6NJGp8AngBqReQbwNPAf49rVBZpLA+9IVO9OcPrC5CV7qKhLM/qUFatucqDf3KWruFJq0OxzMxckDN9o46d1LdQhtvFxgqtPVrVCQ5RbMJkjHlKRA4D+wg1S33UGDMQ98gskOF2saE8/8rM2VTl9fnZvMZDmsvZpVJYMDPcF6C2OMfiaKxx+vIos/OJH5oZL1urCniyvRdjjONrTivl7Q6Q6XbRUJqb8Oe+Zk1DRHZHHkAd0AP4gLXhnyWl5ipPStc0jDG0W9RWGg+b1+ST5pKULpm2J8Gcm4W2VnsYnpilxz9ldSiWafP52VzpwZ2W+FkTS9U0Phv+NwtoAY4SqmlsBw4AN8c3NGs0VXr43qEu+kanKM/PsjqchOscmmR0ai4pmjIAstLT2FCWl9IFgfaeADkZadSXJL5UGg+RbU3buv1UFTp3HtFKGWNo9wV4vUVb9l4zTRlj7jDG3AF0ALuNMS3GmD3ALuBsogJMtJfH9qfmTcaKVTPjLbQ6aurWNLw+P1sqPbiSoLkRYMsaDy4hZV/TruFJAlNzln1Go6nbbDbGHI98Y4xpA3bGLyRrbYmMoErRpNEW3tlt0xpn7ey2lObqAvpGp+kbTb3mjGAwVCpNpkJAdkYa61O49mhlJzhElzROiMiXReR2EbktPDP8RLwDs4onK521xTkpmzS8vgAbypy3s9tSUrn22DE0wfjMfFIlDUjtvkevL0CaS9hsUcEumqTxfsALfBT4Y6A9/LOk1ZTCy4k4eQ+Na2lK4dqj1aXSeGmuKqA3MMXgWFJOGVuS1xdgfVmuZQW76yYNY8yUMebzxpgHwo/PG2OSup7fXOXhwsA4Y9OptUx6ZGe3ZofPBL9apPaYiiOovL4AbpfQWOH8OTcLpfJEXCv20FgomgULL4jI+asfiQjOKpGS6ckUe0M6eU/w60nV5ox2X4AN5XlkupOnuRFe/oym2ms6MDbN5cC0pZ/R607uIzTcNiILeBtQHJ9w7KG56uUJYS31SX2pvyHSfOPUnd2W0lzl4fG2XgJTs3iynLkJ0Up4fQFu21hmdRgxV5iTQXVhdsoljZcLdjauaRhjBhc8uo0x/wS8JgGxWabCk0lxbkbKtYF7fX7WFuck5U018iE7kUKvaV9gioExa0ul8dRU5Um5JsfI9VpZsLtuTeOq2d8uQjWP5BmPuQgRCTVn9KTaGzL5OsEjFo6g2ttQYnE0iZHMzY0Quq6fnbjM+PQcuZnRNJo4n9cGW/ZG8z/92QVfzwEXgLfHJxz7aKr08H9+dZHZ+SDpFkzVT7TA1CwdgxO8bU+N1aHERbkni9K8zJTqOLVDqTSemqsKMCa0n/2eutRoRvZ2W79lbzR3ww9EZocbY+42xnwQmIl3YFZrqvIwMx/kbN+Y1aEkxAkbtJXGW1OKdYa39wSoK8khPwmbGyH15t/YZcveaJLG96L82bKJyL0ickpEzorIxxb5faaIfDv8+wMiUh+L541Gc4qN7U/2pgwIXduZy6NMz81bHUpCJHNzI0BlQRZFOelX9n9JdnbZsnepVW43i8hbgAIRefOCx/sIjaJaFRFJA/4FuA9oAt4pIk1XHfYBYNgYswH4PPD3q33eaK0rzSMrPXW2CvX6ApTmZVLuSd5FGpurPMwFDWcuJ3/tMdLc2FSZvEkj1PdYkDJ9j3aZqLlUTWMT8HqgEHjDgsdu4P+JwXPfAJw1xpw3xswA3wLuv+qY+4GHwl9/D7hTErSAfmiavof2FHpDJnOpFBYOpU7+1zQVmhshVBA43TvG7HzQ6lDiLlSwy6A839ote6/ZEW6MeRh4WERuNMa8GIfnrgY6F3zfBey91jHGmDkR8QMlQEI2gWqq8vDoUV/Sb/YyNTvPmb4x7txSbnUocVVXnENepjslao+p0NwIL/c9nrk8lrQd/hGhLXsLLL8XLdU8FdnS9XdE5AtXP2Lw3Itd+dUbOUdzDCLyQRFpFZHW/v7+GIQW0lzlITA1l/RbhZ6+PMp80CR9qdTlErZU5qdM0kj25kZIndrj9Nw8Zy6P2qIQsFTzVGQl21bg0CKP1eoCahd8X0NoZ8BFjxERN1AADF19ImPMl8L7fbSUlcVu9mukPTjZh2mmSqkUQjeZEz0B5oOvKHsklWTafXEp60pzyU5PS/qCwJnLY8wF7bFl71LNUz8O//vQtY5ZpYNAo4isA7qBdwC/c9UxjwDvBV4E3gr83BiTsE/75vBmL15fgNc2r0nU0yac1+cnP9NNbVHy76HdVOVhYmaei4PjrC9LrkX8IiKl0js2Jd/yIVdLC9cek32Uo106wWGJpCEiP2aRpqAIY8wbV/PE4T6KjwA/BdKA/98Y4xWRTwKtxphHgP8AviYiZwnVMN6xmudcruyMNBrK8lLgDRlgS1Xy7Oy2lIVj+5M1aURKpcnexh/RXFXAD1/qJhg0Sfse9voC5GW6qSu2vmC31Izwf4z3kxtjHgMeu+pnH1/w9RShBRIt01zl4eCFV7SIJY35oOFkzyjvuKH2+gcngcbyfNLThHZfgDdatMdyvNmpVJoIzVUevra/g0tDE9SXJsc+6Ffz+gI02WTL3qX2CH828iDUPDRMqLT/YvhnKaGp0oPPP8XweHJOgr8wMMbk7HzK3GAy3C4ay/OTuuPUTqXSRFi4KnUymg8aTvQEbFNzjGY/jdcB54AvAF8EzorIffEOzC6S/Q2ZSp3gEc1VHtp9ARLYPZZQXl+ALZX5tiiVJsLGNXm4XZK0BYELA+NM2GjL3miWEfkscIcx5nZjzG3AHYRmZ6eEl9vAk/MN6fUFyHC72FCenO37i2mu8jA4PsPlQPJtFRoMl0pTpeYIkOlOY0N5XhIX7OzV3BhN0ugzxpxd8P15oC9O8dhOUW4GVQVZSf2G3FSRnxIr+UZEtrNNxoLAxcFQqdQuTRmJ0lxVkLSf0XZfgIw0l2227I3mTuEVkcdE5H0i8l7gx8DByFpUcY7PFpqqCpLyBmOMoa07wFaLF0BLtC2VHkSSs8kxFZsbIXS9A2PT9AWmrA4l5ry+ABvX5NmmYBdNFFnAZeA24Hagn9B2r28gtDZV0muu8nB+YJyJmTmrQ4mp7pFJ/JOzNNmk2psoeZlu6ktyk7Ig4PUFSE8TGsuTep+0V0jWZdKNMaF14SzeQ2Oh627CZIx5fyICsbPmKg/GhJYm3lNXZHU4MZOqpVIITfI72jlidRgx5/X5aSzPJ8Ntj1JpojQt6Hu8Y3PyrKHW459ieGLW8uXQF4pm9NQ6EfmciPxARB6JPBIRnF1E2sDbk6xk6vUFcAlsWWOfN2SiNFd56BqexD8xa3UoMWOMoT3J99C4lvysdOpKcpKupmHHgl00273+iNDM7B8Dyb/+8CKqCrIozElPujdku89PQ1ke2RlpVoeScFeGUvf4uWl9qcXRxMblwDSD4zO2usEkUnOVh7Yk25DJ6/MjElrSyC6iSRpTxphYrGrrWKHNXpJvq1CvL8AN61Jjb+WrXVmM0hdImqQR6aPZWm2f9u9Eaq4q4LHjvQSmZvEkyRa3Xl+AdaW55GZGc6tOjGgaPv9ZRD4hIjeKyO7II+6R2UxzVQGnekeTZrOXofEZevxTKVsqLcvPpDw/M6nWFWvrDiASGh2WiiL9Gsn0moaaG+1VCIgmfW0D3g28hpebp0z4+5TRHN7s5WzfWFJ8KO02YcgKyVZ7bPP5bVcqTaTmBUljX0OJxdGs3vD4DN0jk7z7xjqrQ/kN0by7HgAawluypqyFQ/qSI2nYr4Mt0ZqrCnjuzABTs/NkpTu/X6fdF0iq0X3LVZ6fRVl+ZtIUBCL7+Gy1WcEumuapo4T2CU9p60rzwpu9JMcIKq8vQHVL+QCXAAAfGElEQVRhNoU5GVaHYpnmKg/zQcOp3lGrQ1m1SKk01SZqXi1Ue0yOz2hbd+g67Da7P5qaRgVwUkQOApHFeowx5v74hWU/aS5hcxJtFert9usNZsFilDtqnV0uernmaK9SaaI1V3n45ZkBpufmyXQ7u/YYKdgV59qrYBdN0vjEgq8FuBl4Z3zCsbfmKg8Pv+Rz/GYvo1OznB8Y54Fd1VaHYqna4mzys9xJUTJtu9JHpQWBuaDhdO8Y22qcnUDbfH5bvp7XbZ4K753hB14HfAW4E3gwvmHZU3NVAaPTc3QOT1gdyqqc6Ak1x6Tq0MwIEaGpMjk6w9u6/Snf3AjJsyr12PQcFwbGbfkZvWbSEJGNIvJxETlBaB+NTkCMMXcYY/5XwiK0kWRZ3+Z4uK3UTksTWKW5qoCTvQHmg87eW6Pdl3oLTy6mtiiH/Ey34z+jof1esOVrulRN4yShWsUbjDE3hxPFfGLCsqeNFfmkJcFmL95uP+X5mZTnZ1kdiuWaqjxMzQY53z9mdSgrFmlutNsoGyu4XMKWJOgMj3SC2/E1XSppvAXoBZ4RkX8XkTsJ9WmkrKz0NBqTYLOXNp/fltVeK1wZ29/j3Nc00tyoNceQ5ioPJ3pGHV17bPP5QxNQPfYr2C21R/gPjTG/DWwGfgH8v0CFiPyriNyToPhsp8nhE8ImZ+Y52zemSSNsQ3keGW6Xo1/TK8uH2LBUaoXmqgImZ+e5MDBudSgr5u0OsM2mn9FoOsLHjTHfMMa8HqgBjgAfi3tkNtVcVUD/6DR9o87c7OVEb4Cgga02HJVhhfQ0F5sq8h3dnNHWHbBtqdQKTu8Mn5yZ50zfqG0/o8tadN8YM2SM+TdjTEotIbKQ0zvDvd2pvajdYiLLiRjjzOYMr02HZlolUnt06hpUJ8MFu2abfkZTa6eWGHD6omht3QGKczOoLNBSaURzlYeRiVl8fufVHqdm5znTN6ZNUwu8XHt06Gc0HLddC3aaNJbJk5XO2uIcx1Z9IxOGRFJ6TMNviGx3G6mFOcmp3lCHrx2HZlopspyIE2uP3m4/RTnpVNm0YKdJYwW2VnuuzHVwkum5eU5fHrVtCcYqWyrzEXFmk6MuH7K45ioPwxOz9Diw9ni8OzS60a4FO00aK7CtupDOoUmGx5218O+Zy2PMzhttyrhKToabhtJcRyaNNp8fT5abmqJsq0OxlaYF64o5SaRgZ+dCgCaNFdgRXtPGabWNKxOGtCnjFZqqChy5B7y3209zlX1LpVZ5ufborNc0UrCz63Bb0KSxIpFRDce6RiyOZHnafH7ys9ysLc6xOhTbaa7y4PNPOar2ODsf5ETvqBYCFuHU2qMTCnaaNFagIDuddaW5HOtyVimmrTugneDX4MSZ4Wf7xpiZC9q6KcNKzVUFjhvl6ISCnSaNFdpeU+Co5qm5+SAnegLan3ENkf8XJ72mkZrudocvAR4vTVUeukec1ffohIKdJUlDRIpF5CkRORP+9xV7VIrIThF5UUS8InJMRH7bilivZVt1AT3+KcfMDD99eYzpuaDj9xiIl6LcDGqLsx3V5Hi0K1QqrS/JtToUW9rqsM7wWYcU7KyqaXwMeNoY0wg8zeLLkkwA7zHGNAP3Av8kIrbZXm17TSiU4w5poorcDHfU2Oa/0Ha21xRytNMZryeEXtPtNQWO3hAsniL9Ase6nVEQONU7yvRckO0230XSqqRxP/BQ+OuHgDddfYAx5rQx5kz4ax/QB5QlLMLraK7y4BIc069xtGuEgux06krs21ZqtR01BXSPTDIwNn39gy02NTvPqd7RK4UX9UqFORnUl+RwzCEFgci9ZKfNX1OrkkaFMaYHIPxv+VIHi8gNQAZwLgGxRSU3082G8jzHNGcc7fSzvUaHZi4lcgN2wmt6sneU2XlzZfi3WtyO2kKOOuD1BDjaOUJRTjq1xfaecxO3pCEiPxORtkUe9y/zPJXA14D3G2OC1zjmgyLSKiKt/f39sQg/KtuqCznebf+lCqZm5zl1eVSbpq4jNAsXRzRRvdwJrq/pUrbXFIb6HgP273s82jXCtppC2xfs4pY0jDF3GWO2LvJ4GLgcTgaRpNC32DlExAP8BPhLY8z+JZ7rS8aYFmNMS1lZ4lqwdtQWMDA2Y/ulCrw+P/NBo6NsriMv002jQ2qPRzv9lOZl6sKT17GzNvSeP2rzZuSJmTlOXx5lpwM+o1Y1Tz0CvDf89XuBh68+QEQygB8CXzXGfDeBsUVtm0Mm+UVKzjts3sFmB9trCjnWZf/a47GuEXZoc+N1NVUWkOYSjnba+zPq9YWWQ3dCzdGqpPEZ4G4ROQPcHf4eEWkRkS+Hj3k7cCvwPhE5En7stCbcxW2p9OB2ie07w491jbDGk0WFbtJzXTtqChgcn6F7ZNLqUK5pbHqOs/1jOnw6CtkZaWyqyLd9v0YkqW2vtf9r6rbiSY0xg8Cdi/y8Ffj98NdfB76e4NCWJSs9jU1r8m0/Iexol1+bpqIUKekd7fRTU2TPkWZt3X6M0eHT0dpRW8Bjx3sxxti2Zna0y09VQRbl+fYv2OmM8FXaXlNg6+YM/+QsFwbGtWkqSpsr80lPE1s3OepM8OXZUVOIf3KWjsEJq0O5pqOdI45omgJNGqu2rdreb8jI5EMtlUYn053GlkqPrZszjnb5qS7MpiQv0+pQHOFK7dGmr+nw+AyXhiYcU7DTpLFKO66MzrDnGzISl7Z/R297TQFt3QGCQXvWHo91jVx536nr21iRR1a6y7ZDqY9eWa3BGa+pJo1V2lSRT05GGoc7hq0OZVFHO0dYV5pLQXa61aE4xo6aQsam5zjXP2Z1KK/QPzpN59Aku2pfsVybugZ3moutVQW2LdhFBtJs1aSRGtxpLnbUFHL4kv3ekMYYjnSOOKYEYxe760I35MOX7FcQiMS0u84ZTRl2saO2kLZuP7Pzi84PttTRzhEaynLxZDmjYKdJIwZ21xXS3hNgYmbO6lB+Q9fwJH2j0+yp01LpcjSU5lKYk84hG9YeD18aJiPNpXtoLNPO2kKm50KryNqJMYbDl4bZs9Y5n1FNGjGwe20R80Fju/kakVLpnrpiiyNxFhFh99oieyaNjmGaqz1kpadZHYqjtNSHbsp2e03PD4wzPDHrqIKdJo0Y2LXWns0ZrReHyc0IzSVRy7Onrohz/eOMTNhnA5+ZuSDHuvzsdlCp1C4qC7KpKsiyXdKIxKNJI8UU52awrjSXwx326tc41DHMrrVFpOl+C8sWuTG/ZKO+qhM9Aabngo66wdjJnvpi2yWNwx3DFGSns74sz+pQoqZJI0Z2rS3kpUvDtpnkNzY9x8newJVOXbU8O2pDaxbZ6SYTiUVrGiuzZ21oxVufjZaIae0YZvfaQkdtpKVJI0b21BUxGJ6kYwdHO0cIGmdVe+0kJ8NNU6XHVknj8KVhqguzWaMr265IS32ob88ur+nIxAxn+8Yc9xnVpBEju23Wr3GoYxiR0KgRtTJ76oo42jXCnE2GaR7uGGbXWn09V2rzmnyy09NskzQiTZ9OG6iiSSNGNlbkk5fptk2/xqGOYTaW5+ukvlXYtbaQiZl5TvaOWh0KPf5JfP4px5VK7cSd5mJnbaFtksahjmHSXOK42f2aNGIk8uLb4Q0ZDIbGfmt/xurssdEkv0hhRPszVqelvoj2ngDj09bPqWrtGKKp0kNOhiWLja+YJo0Y2rO2iJO9AcYsfkOe6RtjdGpOS6WrVF2YTYUn0xYFgcOXhslKd9FU5bE6FEfbXReaU2X1kiKz80GOdvod+RnVpBFDr1pXTNBA68UhS+Nw4thvOxIR9tTZY5Jf68UhttcUkp6mH9nVuNL3aPFrerJnlMnZeUd+RvUdGEN76opwu4RfX7A2abReHKIkN4P6EntuIuQkr6ovpmt40tKd/EanZjne7WffOmd1mNpRQXY6GyvyaLU4abR2hO4RmjRSXE6Gm201BRywMGkYY9h/fpC9DcW23aXMSfY1lABw4PygZTG0dgwTNC/Holanpb6YQxeHLR0Vd+D8EDVF2VQVZlsWw0pp0oixvetKONY1wuTMvCXP3zkUGmWjN5jY2FSRT2FOOvstTBr7zw+SniZXlqtRq3NjQwmj03N4fdYsXhgMGvZfGORGh35GNWnE2N6GYmbnjWUjbiI3N00aseFyCTfUF7P/vHW1xwPnh9hRU0h2hi5SGAt7G0LNfC9aVBA4dXmUkYlZx35GNWnEWEtdES6xrjnjxfODlORm0FjunLVs7G5fQwmXhiYsWX5ibHou1J/h0BuMHZXnZ7GhPI8Xz1n0GQ0/7771znxNNWnEWH5WOs1VBey3oF8j0p+xr6FE+zNi6Eq/xoXE32QOdQwzHzRXSscqNm5sKKH14pAlmzLtPz/I2uIcqh3YnwGaNOJi77pijnSOMDWb2H6NS0MT9Pin2Kc3mJjavCY0s37/ucQXBPafH8TtEkeOsrGzfQ0ljM/Mc7w7sXvgBIOGAxeGHNufAZo04uKmDSXMzAVpvZjYfg3tz4gPl0u4YV2xJW3gL54bZHtNgeNmDdtdpGCV6Caq9p4A/slZ9q13bsFOk0Yc7F1XQnqa8PyZ/oQ+74vnBinNy2CD9mfE3E3rQ/0anQlcxdg/McuxrhFubixL2HOmipK8TDZV5Cd8VFwyFOw0acRBbqabPXVFPHdmIGHPGQwanj8zwKs3lGp/RhzcEr5xP5fAgsCvzg0QNHBrY2nCnjOV3Li+hIMXhxLajPz8mQEaSnOpLHBmfwZo0oibWxrLONEToG90KiHP5/UFGByf4baNWiqNh/VluVQXZvPsqcQljedO95Of5dbl7ePkto1lTM0GE7aCw9TsPPvPD3LbJmd/RjVpxMmt4ZLpr84mprbx7Ok+4OUSsYotEeHWjWW8cG4wISNujAnXHNeX4tb1puJiX0MJGW4Xv0hQQeDAhSGm54KOL9jpuzFOmqs8FOWk8/zpRCWNfrZWeyjLz0zI86Wi2zaWMjY9l5B9w8/1j9M9MsktG7VpKl6yM9LYu674SoEr3p491U+m2+Xo/gzQpBE3Lpdwc2MZz50ZiPu+4YGpWQ5fGnF8CcbubtpQSppLEnKTiQyiuFVrjnF1+6ZyzvWPJ2SAwy9O97G3oYSsdGfP7NekEUe3NJYyMDZNe09817h54ewA80HDbRvL4/o8qc6Tlc7utYU8l4Da43On+1lXmkttsa5UHE+RgtYvTse3iapzaILz/ePcngQFO0uShogUi8hTInIm/O81Zy6JiEdEukXki4mMMRbu2FSOCDzVfjmuz/Ps6X7yM926f3QC3NpYxvFuf1wHOEzMzPHCuUGtOSbA+rJcaoriP8Dh2XBScnonOFhX0/gY8LQxphF4Ovz9tXwKeDYhUcVYWX4me9YW8aQ3fkkjGDT87EQfNzeW6gY9CXBXUwUAP2uPXxPVs6f6mZ4L8trmNXF7DhUiIty2sYwXzg3Edejt0ycuU1OUTUNpbtyeI1GsusvcDzwU/voh4E2LHSQie4AK4MkExRVz9zRX0N4TiFub6eFLw/SPTnPvVr3BJMLmNfnUleTwhLc3bs/xU28vRTnpvKpelw5JhHua1zAxM8/zcZpXFZia5ZdnB7i3eU1SzKGyKmlUGGN6AML/vqIxXkRcwGeB/5bg2GLq7qbQzTxeTVSPt/WSkebiNZu1PyMRRIR7m9fw4rkB/JOzMT//zFyQp0/2ceeWCh1qmyA3rS+hIDudx4/3xOX8Pz/Rx+y84b5tyVGwi9u7UkR+JiJtizzuj/IUfwA8ZozpjOK5PigirSLS2t+f2KU7rmddaS4bK/J4sj32JVNjDE+09XJzYyn5WekxP79a3D3Na5idNzxzMvZNVAcuDDI6NadNUwmUnubi7qYKnjpxmZm52M/BebythwpPJrtqk6PmGLekYYy5yxizdZHHw8BlEakECP+72KfvRuAjInIR+EfgPSLymWs815eMMS3GmJayMvt1NN3TtIaDF4cZHp+J6XnbugN0j0xq01SC7aotpDw/kyfaYl8Q+Km3l+z0NG7RpUMS6r6taxidmuNX52LbRDUxM8ezp/t5bfMaXC7nN02Bdc1TjwDvDX/9XuDhqw8wxvyuMWatMaYe+DPgq8aYpTrMbeverWuYD5qYt4M/3tZDmku4e0tFTM+rluZyCfc0V/Ds6f6Ybus7HzQ86b3MbRvLHD+W32lubiwlL9PNE8dj+xn9xal+pmaDSVWwsyppfAa4W0TOAHeHv0dEWkTkyxbFFDfNVR4aynL50UvdMTunMYbHjvewr6GYotyMmJ1XRee3tlUyOTvPUydi11f1wrkB+kanecOOqpidU0Un053GXVvKebK9N6bLxDx2vIeS3AxuqHfuUuhXsyRpGGMGjTF3GmMaw/8OhX/eaoz5/UWO/4ox5iOJjzQ2RIQHdlZz4MIQ3THaMvRQxzAXByd4087qmJxPLc++dSVUFWTxg8NdMTvnDw93k5/l5s4tOqjBCq/fXsXwxGzM1qLyT87yVPtlfmtbZVINakieK7G5+8M394ePxKa28f3DXWSnp3HftsqYnE8tj8slPLC7mudO98dkot/EzBxPeHt53bZKbZqyyG2byijNy+R7h6479iYqPznWw/RckLe11MTkfHahSSNB1pbkcEN9Md852EkwuLq1qKZm53n0aA/3bV1DXqbu6GaVB3bVEDTEpNnxJ8d6mJiZ5027tOZolfQ0Fw/squLpE30Mjk2v+nzfO9TJxoo8tlUXxCA6+9CkkUC/u28tFwcnVj1C48dHfYxOz/HWJCvBOM2G8jxa6or4xoFLqy4IfP3AJdaX5bJ3XfK0fTvR21pqmQsavr/KZsdTvaMcvjTCW/fUJMWEvoU0aSTQvVvXUJybwTf2X1rxOYwxfOWFi2ysyHP05vTJ4j031dMxOMGzq9jR71jXCEc7R3j3vrqku8E4zcaKfG5YV8xDL3Qwt4oO8a+8cIGsdBdv21Mbw+jsQZNGAmW603hbSw1Pnbi84mVFWjuG8foCvO+mdXqDsYF7m9dQlp/JV1+4uOJzPPRCBzkZabx5j9Yc7eD3Xr2O7pFJfrbCkXHD4zP84HA3D+yqTsqRjZo0Euz9N63DJfBvz51b0d//27PnKchO5027dFimHWS4Xbxrbx3PnOqn3bf8JfA7hyZ4+Eg3b2+pxaOz+m3h7qYKaoqy+ffnL6xoL5yv7+9gei7I+25aF4forKdJI8HWFGTx1j01fKe1i77A8kbdHO/y87MTl/n9m9eRk6Ed4Hbxvpvqyc9084Wnzyz7bx989hwuET50W0McIlMrkeYSPnRrA4c6hpe9iKF/cpZ/f/48d22pYNOa/DhFaC1NGhb40K3rmQ8a/mmZN5nP/+w0hTnpvO/V9fEJTK1IQU467391PU94e2nr9kf9dx2D43y3tYu3ttRQWZAdxwjVcr39VbVUF2bzj0+eWlZt4z+eP09gao4/uXtjHKOzliYNC9SX5vKeG+v4z19fwuuL7ibz85OX+fnJPj5063pdnNCGPnBzA8W5GXziEW/UI6k+9Wg76WnCR+9sjHN0arky3Wl89K5GjnX5+WGUQ6o7hyb40vPned22SpqqPHGO0DqaNCzyx3dtpCgng7/8Udt1ly2YmJnjr37kZUN5Hh+4OTnbSZ2uICedP79vM4c6hvl26/Unhz3p7eVnJ/r4ozsbqfBkJSBCtVxv2V3D7rWFfPLRdgauM2/DGMP/98PjuF0u/vL1WxIUoTU0aVikIDudv3ljMy9dGuGzT56+5nHGGD72/eP4/JN8+oFtZLj1JbOrt+6p4caGEj7543ZOLLEvfOfQBP/te8doqvTw/ldrIcCu0lzC379lOxPT8/zZd48uOQT3P355gefPDPDfXrsp6Zsa9Q5koTfsqOKdN6zlwWfP8bX9Ha/4vTGGzz11mkeO+vizezZxg078sjUR4Z/fuRNPtpsPfq110WHVfYEpfv+hVoLG8K/v2q2FAJtrrMjnr9/YzC9O9V+z6fHx4z38j8dOcN/WNbx7X50FUSaWvmMt9ok3NHHn5nL+6kdt/N3jJxidCu0GNzA2zR9/+wj/6+dnedueGv7g9vUWR6qiUZ6fxZfe3UJgco4H/veveOZkH8YYjDHsPz/IWx58gc7hCR581x7qSpy/X3Qq+J29a/nQbQ1848AlPvDQQXr8oUVHJ2fm+dxTp/mDbx5mR00hn337jqTZM2MpspJxyHbW0tJiWltbrQ5jWWbng3z84Tb+89edZLhdVHgy8Y1MYYzhj+/ayB++ZoNO5HOYs31jfPCrrZwfGKckNwOXS+gfnaaqIIv//a497KwttDpEtQzGGL5+4BKf/LGXuaChpiib/tFppmaDPLCrmk8/sI3sDGcvNCkih4wxLdc9TpOGfRzv8vPjYz4uB6aoLcrhTbuq2VCeZ3VYaoWm50ILSx64MEjQwJ66Iu7fWaVzbBysc2iC7x/u4sLAOCW5mdy3bQ2vSpK9MjRpKKWUilq0SUP7NJRSSkVNk4ZSSqmoadJQSikVNU0aSimloqZJQymlVNQ0aSillIqaJg2llFJR06ShlFIqakk3uU9E+oFXrv5nnVJgedt/OZ9ec2rQa04udcaYsusdlHRJw25EpDWaWZbJRK85Neg1pyZtnlJKKRU1TRpKKaWipkkj/r5kdQAW0GtODXrNKUj7NJRSSkVNaxpKKaWipkljGUTkXhE5JSJnReRji/w+U0S+Hf79ARGpD/+8RESeEZExEfniguNzROQnInJSRLwi8pnEXU10Yn3NV/3tIyLSFt8rWL54XLOIZIjIl0TkdPj1fktiriY6cbrmd4rIcRE5JiJPiEhpYq4mOqu45rtF5FD42g6JyGsW/M2e8M/PisgXJBm33IzsX6yPpR9AGnAOaAAygKNA01XH/AHwYPjrdwDfDn+dC9wMfBj44oLjc4A7wl9nAM8D91l9rfG85gV/92bgm0Cb1deZiGsG/gb42/DXLqDU6muN5zUDbqAvcp3APwB/bfW1xuiadwFV4a+3At0L/ubXwI2AAI/b6fMcq4fWNKJ3A3DWGHPeGDMDfAu4/6pj7gceCn/9PeBOERFjzLgx5pfA1MKDjTETxphnwl/PAIeBmnhexDLF/JoBRCQP+BPgb+MX+orF5ZqB3wP+DsAYEzTG2GmCWDyuWcKP3HBp2wP44nYFy7eaa37JGBO5Fi+QFa6VVAIeY8yLJpRBvgq8Kf6XkliaNKJXDXQu+L4r/LNFjzHGzAF+oCSak4tIIfAG4OlVRxo78brmTwGfBSZiE2ZMxfyaw68twKdE5LCIfFdEKmIX8qrF/JqNMbPAfwGOE0oWTcB/xC7kVYvVNb8FeMkYMx0+vus653Q8TRrRW6xt8uqhZ9Ec88oTi7iB/wS+YIw5v4LY4iXm1ywiO4ENxpgfriawOIrH6+wmVIP8lTFmN/Ai8I8rCy8u4vE6pxNKGruAKuAY8OcrDTAOVn3NItIM/D3woWWc0/E0aUSvC6hd8H0Nr6xuXzkmnAgKgKEozv0l4Iwx5p9iEGcsxeOabwT2iMhF4JfARhH5RYzijYV4XPMgoVpVJFF+F9gdi2BjJB7XvBPAGHMu3FTzHeCmWAUcA6u6ZhGpIfR6vscYc27B8Qublxc7p+Np0ojeQaBRRNaJSAahjrFHrjrmEeC94a/fCvw8/IG5JhH5W0Jvxj+OcbyxEPNrNsb8qzGmyhhTT6gD9bQx5vaYR75y8bhmA/wYuD38ozuB9lgGvUrxeG93A00iElkA727gRAxjXq0VX3O4ufEnwJ8bY34VOdgY0wOMisi+cD/Oe4CH430hCWd1T7yTHsBvAacJjbr4i/DPPgm8Mfx1FqFS5FlCoygaFvztRUKllDFCJZImQiURQ+jDdCT8+H2rrzOe13zVueux2eipeF0zUAc8R6iZ5mlgrdXXmYBr/nD4vX2MUNIssfo6Y3HNwF8C4ws+s0eA8vDvWoC28Dm/SHgCdTI9dEa4UkqpqGnzlFJKqahp0lBKKRU1TRpKKaWipklDKaVU1DRpKKWUipomDaWUUlHTpKHUNYSX/T4SfvSKSPeC71+Iw/O9T0T6ReTLSxyTHX7+GbstNa5Sg9vqAJSyK2PMIOHlMETkr4ExY0y814z6tjHmI0vENAnsDC/DolTCaU1DqRUQkbHwv7eLyLMi8p3wBkufEZHfFZFfhzfjWR8+rkxEvi8iB8OPV0fxHM3h8xwJb2TUGO/rUup6tKah1OrtALYQWkrjPPBlY8wNIvJR4A8JrSv2z8DnjTG/FJG1wE/Df7OUDwP/bIz5Rnh9pLS4XYFSUdKkodTqHTShxeoQkXPAk+GfHwfuCH99F6EF/CJ/4xGRfGPM6BLnfRH4i/CKqj8wxpyJfehKLY82Tym1etMLvg4u+D7IywUzF3CjMWZn+FF9nYSBMeabwBuBSeCnC/eiVsoqmjSUSowngSsd3OHNqJYkIg3AeWPMFwgt0709fuEpFR1NGkolxh8BLeEO7XZC/RXX89tAm4gcATYT2nNaKUvp0uhK2YSIvA9oWWrI7YJjL4aPHYh3XEotpDUNpexjErgvmsl9QDqhPhOlEkprGkoppaKmNQ2llFJR06ShlFIqapo0lFJKRU2ThlJKqahp0lBKKRW1/wuwWFcs5YaosgAAAABJRU5ErkJggg==
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;A simple sine wave!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://simonstolarczyk.com/images/wave.svg" /><media:content medium="image" url="http://simonstolarczyk.com/images/wave.svg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Trying Out HuggingFace</title><link href="http://simonstolarczyk.com/jupyter/2020/08/15/huggingface_test.html" rel="alternate" type="text/html" title="Trying Out HuggingFace" /><published>2020-08-15T00:00:00-05:00</published><updated>2020-08-15T00:00:00-05:00</updated><id>http://simonstolarczyk.com/jupyter/2020/08/15/huggingface_test</id><content type="html" xml:base="http://simonstolarczyk.com/jupyter/2020/08/15/huggingface_test.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-08-15-huggingface_test.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Updated-Blog-Posting-Method&quot;&gt;Updated Blog Posting Method&lt;a class=&quot;anchor-link&quot; href=&quot;#Updated-Blog-Posting-Method&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;After going through the pain of converting a Notebook to a markdown file and then editing that markdown file to look nice (in my last post), I saw that there was a better way to hand that process: &lt;a href=&quot;https://github.com/fastai/fastpages&quot;&gt;fastpages&lt;/a&gt;. The process was slightly rocky, but I finally think I have things more or less figured out, including linking it to a domain under my name!&lt;/p&gt;
&lt;p&gt;As a first test of the capability of uploading a notebook to a blog post, I am going to toy with the &lt;a href=&quot;https://huggingface.co/&quot;&gt;Hugging Face models&lt;/a&gt;. Interesting name for a company/group, with lots of Alien vibes. I saw this super cool tweet:

&lt;center&gt;
    &lt;div class=&quot;jekyll-twitter-plugin&quot;&gt;&lt;blockquote class=&quot;twitter-tweet&quot;&gt;&lt;p lang=&quot;en&quot; dir=&quot;ltr&quot;&gt;No labeled data? No problem.&lt;br /&gt;&lt;br /&gt;The  Transformers master branch now includes a built-in pipeline for zero-shot text classification, to be included in the next release.&lt;br /&gt;&lt;br /&gt;Try it out in the notebook here: &lt;a href=&quot;https://t.co/31Z6LR1NjK&quot;&gt;https://t.co/31Z6LR1NjK&lt;/a&gt; &lt;a href=&quot;https://t.co/IugPUj3sa1&quot;&gt;pic.twitter.com/IugPUj3sa1&lt;/a&gt;&lt;/p&gt;&amp;mdash; Hugging Face (@huggingface) &lt;a href=&quot;https://twitter.com/huggingface/status/1293240692924452864?ref_src=twsrc%5Etfw&quot;&gt;August 11, 2020&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async=&quot;&quot; src=&quot;https://platform.twitter.com/widgets.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt;
&lt;/div&gt;
&lt;/center&gt;
&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Per the &lt;a href=&quot;https://huggingface.co/transformers/installation.html&quot;&gt;instructions here&lt;/a&gt; I made a virtual environment to try out some transformers:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;pyenv virtualenv &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;.8 hface
pyenv activate hface
pip install jupyter
pip install --upgrade pip
pip install torch
pip install transformers
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;And then I tested with:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;python -c &lt;span class=&quot;s2&quot;&gt;&amp;quot;from transformers import pipeline; print(pipeline(&amp;#39;sentiment-analysis&amp;#39;)(&amp;#39;I hate you&amp;#39;))&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Which gave a correct sentiment score, I think at least, a negative score close to 1.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;transformers&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pipeline&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pipeline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sentiment-analysis&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;jog off&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[{&amp;#39;label&amp;#39;: &amp;#39;NEGATIVE&amp;#39;, &amp;#39;score&amp;#39;: 0.905813992023468}]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pipeline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sentiment-analysis&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;exactly&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[{&amp;#39;label&amp;#39;: &amp;#39;POSITIVE&amp;#39;, &amp;#39;score&amp;#39;: 0.9990326166152954}]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pipeline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sentiment-analysis&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;I saw this super cool tweet&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[{&amp;#39;label&amp;#39;: &amp;#39;POSITIVE&amp;#39;, &amp;#39;score&amp;#39;: 0.998775064945221}]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Very cool!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Trying-Out-Pipelines&quot;&gt;Trying Out Pipelines&lt;a class=&quot;anchor-link&quot; href=&quot;#Trying-Out-Pipelines&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;I attempted running a zero-shot classifier, but got an error (&lt;code&gt;&quot;Unknown task zero-shot-classification, available tasks are ['feature-extraction', 'sentiment-analysis', 'ner', 'question-answering', 'fill-mask', 'summarization', 'translation_en_to_fr', 'translation_en_to_de', 'translation_en_to_ro', 'text-generation']&quot;&lt;/code&gt;). I guess this is because it is a new feature that hasn't quite made it to the latest version:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;classifer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pipeline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;zero-shot-classification&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Instead, I will play around with some of the other classifers.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;en_to_de_translate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pipeline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;translation_en_to_de&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;


&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;/home/simon/.pyenv/versions/3.8.3/envs/hface/lib/python3.8/site-packages/transformers/modeling_auto.py:796: FutureWarning: The class `AutoModelWithLMHead` is deprecated and will be removed in a future version. Please use `AutoModelForCausalLM` for causal language models, `AutoModelForMaskedLM` for masked language models and `AutoModelForSeq2SeqLM` for encoder-decoder models.
  warnings.warn(
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;Some weights of T5ForConditionalGeneration were not initialized from the model checkpoint at t5-base and are newly initialized: [&amp;#39;encoder.embed_tokens.weight&amp;#39;, &amp;#39;decoder.embed_tokens.weight&amp;#39;, &amp;#39;lm_head.weight&amp;#39;]
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;en_to_de_translate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;no&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[{&amp;#39;translation_text&amp;#39;: &amp;#39;nein, nein, nein, nein!&amp;#39;}]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Checks out. Let's see if some other stuff accords with my degrading knowledge of German:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;en_to_de_translate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;this is my room&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[{&amp;#39;translation_text&amp;#39;: &amp;#39;das ist mein Raum.&amp;#39;}]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;I probably would have used Zimmer instead of Raum, since Raum is more &quot;space&quot; than &quot;room&quot; to me.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;en_to_de_translate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;monkey, hippo, porcupine, dog, cat, rabbit&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[{&amp;#39;translation_text&amp;#39;: &amp;#39;Affen, Hippo, Pfauen, Hunde, Katzen, Kaninchen, Hunde, Katzen, Kaninchen.&amp;#39;}]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;It looks like it uses the plural for nouns. Hippo didn't translate to anything different, apparently Flusspferd (water horse) is favored by Leo. I like Stachelschwein (&quot;spike pig&quot;) better for porcupine (which apparently &lt;a href=&quot;http://www.landmarkwildlife.com/porcupines-in-texas-a-sticky-subject/&quot;&gt;live in Texas now!?&lt;/a&gt;) and furthermore Pfauen looks to actual mean peacocks. I'm not sure why dog (Hund), cat (Katze), and rabbit (Kaninchen) are repeated, but those look good.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Thus it's not perfect, but something that took less than a minute can out-translate my 4-ish years of German classes that I haven't touched up on in like a decade. Ouch.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Named-Entity-Recognition&quot;&gt;Named Entity Recognition&lt;a class=&quot;anchor-link&quot; href=&quot;#Named-Entity-Recognition&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Finally, to cap off this short test post let's try out the named entity recognition task. They provide an example of the classifier &lt;a href=&quot;https://huggingface.co/transformers/task_summary.html#named-entity-recognition&quot;&gt;in their docs&lt;/a&gt; as well as a short list of what different abbreviations mean:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;O, Outside of a named entity&lt;/li&gt;
&lt;li&gt;B-MIS, Beginning of a miscellaneous entity right after another miscellaneous entity&lt;/li&gt;
&lt;li&gt;I-MIS, Miscellaneous entity&lt;/li&gt;
&lt;li&gt;B-PER, Beginning of a persons name right after another persons name&lt;/li&gt;
&lt;li&gt;I-PER, Persons name&lt;/li&gt;
&lt;li&gt;B-ORG, Beginning of an organisation right after another organisation&lt;/li&gt;
&lt;li&gt;I-ORG, Organisation&lt;/li&gt;
&lt;li&gt;B-LOC, Beginning of a location right after another location&lt;/li&gt;
&lt;li&gt;I-LOC, Location&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ner&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pipeline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ner&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;




&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;First using their example:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sequence&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Hugging Face Inc. is a company based in New York City. Its headquarters are in DUMBO, therefore very&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;close to the Manhattan Bridge which is visible from the window.&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pprint&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pprint&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;entry&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ner&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sequence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;pprint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;entry&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;{&amp;#39;entity&amp;#39;: &amp;#39;I-ORG&amp;#39;, &amp;#39;index&amp;#39;: 1, &amp;#39;score&amp;#39;: 0.9995632767677307, &amp;#39;word&amp;#39;: &amp;#39;Hu&amp;#39;}
{&amp;#39;entity&amp;#39;: &amp;#39;I-ORG&amp;#39;, &amp;#39;index&amp;#39;: 2, &amp;#39;score&amp;#39;: 0.9915938973426819, &amp;#39;word&amp;#39;: &amp;#39;##gging&amp;#39;}
{&amp;#39;entity&amp;#39;: &amp;#39;I-ORG&amp;#39;, &amp;#39;index&amp;#39;: 3, &amp;#39;score&amp;#39;: 0.9982671737670898, &amp;#39;word&amp;#39;: &amp;#39;Face&amp;#39;}
{&amp;#39;entity&amp;#39;: &amp;#39;I-ORG&amp;#39;, &amp;#39;index&amp;#39;: 4, &amp;#39;score&amp;#39;: 0.9994403719902039, &amp;#39;word&amp;#39;: &amp;#39;Inc&amp;#39;}
{&amp;#39;entity&amp;#39;: &amp;#39;I-LOC&amp;#39;, &amp;#39;index&amp;#39;: 11, &amp;#39;score&amp;#39;: 0.9994346499443054, &amp;#39;word&amp;#39;: &amp;#39;New&amp;#39;}
{&amp;#39;entity&amp;#39;: &amp;#39;I-LOC&amp;#39;, &amp;#39;index&amp;#39;: 12, &amp;#39;score&amp;#39;: 0.9993270635604858, &amp;#39;word&amp;#39;: &amp;#39;York&amp;#39;}
{&amp;#39;entity&amp;#39;: &amp;#39;I-LOC&amp;#39;, &amp;#39;index&amp;#39;: 13, &amp;#39;score&amp;#39;: 0.9993864893913269, &amp;#39;word&amp;#39;: &amp;#39;City&amp;#39;}
{&amp;#39;entity&amp;#39;: &amp;#39;I-LOC&amp;#39;, &amp;#39;index&amp;#39;: 19, &amp;#39;score&amp;#39;: 0.9825621843338013, &amp;#39;word&amp;#39;: &amp;#39;D&amp;#39;}
{&amp;#39;entity&amp;#39;: &amp;#39;I-LOC&amp;#39;, &amp;#39;index&amp;#39;: 20, &amp;#39;score&amp;#39;: 0.9369831085205078, &amp;#39;word&amp;#39;: &amp;#39;##UM&amp;#39;}
{&amp;#39;entity&amp;#39;: &amp;#39;I-LOC&amp;#39;, &amp;#39;index&amp;#39;: 21, &amp;#39;score&amp;#39;: 0.8987104296684265, &amp;#39;word&amp;#39;: &amp;#39;##BO&amp;#39;}
{&amp;#39;entity&amp;#39;: &amp;#39;I-LOC&amp;#39;,
 &amp;#39;index&amp;#39;: 29,
 &amp;#39;score&amp;#39;: 0.9758240580558777,
 &amp;#39;word&amp;#39;: &amp;#39;Manhattan&amp;#39;}
{&amp;#39;entity&amp;#39;: &amp;#39;I-LOC&amp;#39;, &amp;#39;index&amp;#39;: 30, &amp;#39;score&amp;#39;: 0.9902493953704834, &amp;#39;word&amp;#39;: &amp;#39;Bridge&amp;#39;}
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Impressive, especially how it recognizes DUMBO as a location. (side note, I actually visited that area in my first trip to NYC last year).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Looking forward to trying out these transformers more in the future!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://simonstolarczyk.com/images/huggingface_logo.svg" /><media:content medium="image" url="http://simonstolarczyk.com/images/huggingface_logo.svg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Circulant Matrices and the Discrete Fourier Transform</title><link href="http://simonstolarczyk.com/fastpages/2020/08/09/circulants_and_DFT.html" rel="alternate" type="text/html" title="Circulant Matrices and the Discrete Fourier Transform" /><published>2020-08-09T00:00:00-05:00</published><updated>2020-08-09T00:00:00-05:00</updated><id>http://simonstolarczyk.com/fastpages/2020/08/09/circulants_and_DFT</id><content type="html" xml:base="http://simonstolarczyk.com/fastpages/2020/08/09/circulants_and_DFT.html">&lt;h1 id=&quot;circulant-matrices-and-the-discrete-fourier-transform&quot;&gt;Circulant Matrices and the Discrete Fourier Transform&lt;/h1&gt;

&lt;p&gt;While reading &lt;a href=&quot;https://towardsdatascience.com/deriving-convolution-from-first-principles-4ff124888028&quot;&gt;this great post&lt;/a&gt; I saved off the paper that it references: &lt;a href=&quot;https://arxiv.org/abs/1805.05533&quot;&gt;Discovering transforms: a tutorial on circulant matrices, circular convolution, and the discrete Fourier transform&lt;/a&gt; by Bassam Bamieh. This last week, I dug into the paper and found it super readable and interesting. So this is just my digging into some of the details and making pictures to help things make sense for me.&lt;/p&gt;

&lt;h2 id=&quot;discrete-fourier-transform&quot;&gt;Discrete Fourier Transform&lt;/h2&gt;

&lt;p&gt;The Discrete Fourier Transform (DFT) is a very useful operator that takes a tuple of complex numbers to another tuple of complex numbers. You typically see it defined as an operator on length-n complex vectors
$\mathrm{DFT}: \mathbb{C}^n \to \mathbb{C}^n$ as a rule which sends $a \mapsto \hat{a}$:&lt;/p&gt;

&lt;span class=&quot;katex-display&quot;&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mover accent=&quot;true&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;^&lt;/mo&gt;&lt;/mover&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mfrac&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;\hat{a}_k := \sum_{l = 0}^{n-1} a_l e^{-i\frac{2\pi}{n}kl}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.84444em;vertical-align:-0.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord accent&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.69444em;&quot;&gt;&lt;span style=&quot;top:-3em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;accent-body&quot; style=&quot;left:-0.25em;&quot;&gt;^&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;:&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.36687em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:3.1032260000000003em;vertical-align:-1.302113em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mop op-limits&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.8011130000000002em;&quot;&gt;&lt;span style=&quot;top:-1.8478869999999998em;margin-left:0em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.05em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;mrel mtight&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.0500049999999996em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.05em;&quot;&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;mop op-symbol large-op&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-4.300005em;margin-left:0em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.05em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;mbin mtight&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.302113em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.0040200000000001em;&quot;&gt;&lt;span style=&quot;top:-3.4130000000000003em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mopen nulldelimiter sizing reset-size3 size6&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8443142857142858em;&quot;&gt;&lt;span style=&quot;top:-2.656em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size3 size1 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;n&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.2255000000000003em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;frac-line mtight&quot; style=&quot;border-bottom-width:0.049em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.384em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size3 size1 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03588em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.344em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter sizing reset-size3 size6&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;

&lt;p&gt;The issue is that this kind of comes out of nowhere. You might see it in a course without knowing anything about complex analysis or linear algebra where the transform will be defined, perhaps used as an excuse to explain some of the basics of complex analysis, then some properties of the transform will be derived and youll use it as a tool for say, solving ODEs. There is a &lt;a href=&quot;https://en.wikipedia.org/wiki/Discrete_Fourier_transform&quot;&gt;lot of depth&lt;/a&gt; to this transformation. Rather than discuss its interpretation and uses, I will give some of the high level details of the Bamieh paper which shows how to arrive at it from naturally exploring circular convolutions.&lt;/p&gt;

&lt;h2 id=&quot;define-vectors&quot;&gt;Define Vectors&lt;/h2&gt;

&lt;p&gt;For all the examples we will run, we make two simple vectors:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;circular-convolutions&quot;&gt;Circular Convolutions&lt;/h2&gt;

&lt;p&gt;A &lt;a href=&quot;https://en.wikipedia.org/wiki/Convolution&quot;&gt;convolution&lt;/a&gt; of two functions $f, g$ is a way to produce a third function that has properties of the two components:
&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo&gt;&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&lt;/mi&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&lt;/mi&gt;&lt;/msubsup&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&lt;/mo&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;f \star g (t) = \int_{-\infty}^\infty f(\tau) g(t - \tau) d \tau&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.8888799999999999em;vertical-align:-0.19444em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.10764em;&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.273443em;vertical-align:-0.41415100000000005em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mop&quot;&gt;&lt;span class=&quot;mop op-symbol small-op&quot; style=&quot;margin-right:0.19445em;position:relative;top:-0.0005599999999999772em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8592920000000001em;&quot;&gt;&lt;span style=&quot;top:-2.34418em;margin-left:-0.19445em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.2579000000000002em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.41415100000000005em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.10764em;&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.1132em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03588em;&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.1132em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.1132em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;Vector convolutions are similar, and we can think of it as a discrete version of the . When you use the &lt;a href=&quot;https://numpy.org/doc/stable/reference/generated/numpy.convolve.html&quot;&gt;built in functions from numpy for the convolution of two vectors&lt;/a&gt; you are using this definition:
&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&lt;/mi&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&lt;/mi&gt;&lt;/msubsup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;a \star x [k] = \sum_{l = \infty}^{\infty} a[l] x[k - l]&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.46528em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.104002em;vertical-align:-0.29971000000000003em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mop&quot;&gt;&lt;span class=&quot;mop op-symbol small-op&quot; style=&quot;position:relative;top:-0.0000050000000000050004em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.804292em;&quot;&gt;&lt;span style=&quot;top:-2.40029em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;mrel mtight&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.2029em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.29971000000000003em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;The idea is that you are thinking of infinite-dimensional vectors indexed by the integers. So, when you plug in vectors like &lt;code class=&quot;highlighter-rouge&quot;&gt;[1, 2, 3]&lt;/code&gt; you are interpreting them as &lt;code class=&quot;highlighter-rouge&quot;&gt;[..., 0, 0, 0, 1, 2, 3, 0, 0, 0, ...]&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;The default mode of &lt;code class=&quot;highlighter-rouge&quot;&gt;np.convolve&lt;/code&gt; is full, but there are also same and valid modes. Full executes the convolution, but clips the output one index after the results are all zeros:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;convolve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'full'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;18&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;convolve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'full'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Same returns an output that has the same size as the bigger input:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;convolve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'same'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;18&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;convolve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'same'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Valid only returns the output where the signals fully overlapped:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;convolve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'valid'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;convolve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'valid'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The &lt;a href=&quot;https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.convolve.html&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;scipy&lt;/code&gt; implementation&lt;/a&gt; is similar&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;scipy&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;signal&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;signal&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;convolve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;18&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;However, we are interested in the &lt;strong&gt;circular&lt;/strong&gt; convolution, where we treat the domain as periodic. Rather than summing over all of the integers, we are thinking of doing arithmetic modulo n. Thus it is useful to view vectors are being circularly arranged:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../../../images/circle_vector.svg&quot; alt=&quot;test2&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Then the circular convolution of two vectors is defined:
&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;a \star x [k] = \sum_{l = 0}^{n-1} a_{k -l} x_l&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.46528em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.253718em;vertical-align:-0.29971000000000003em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mop&quot;&gt;&lt;span class=&quot;mop op-symbol small-op&quot; style=&quot;position:relative;top:-0.0000050000000000050004em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.954008em;&quot;&gt;&lt;span style=&quot;top:-2.40029em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;mrel mtight&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.2029em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;mbin mtight&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.29971000000000003em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.3361079999999999em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.03148em;&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;mbin mtight&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.208331em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot; style=&quot;margin-right:0.01968em;&quot;&gt;l&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;
this is described in more detail in the paper.&lt;/p&gt;

&lt;p&gt;To visualize this first we use a drawing to indicate the inner product of two vectors by stacking the circular representation of one on top of the other:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../../../images/comp_mult.svg&quot; alt=&quot;component-wise multiplication&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We multiply components by matching the top circular vector to the bottom one. Using this, we get the circular convolution of two vectors by&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;reversing the first argument vector so that it goes from 0 to $n-1$ clockwise rather than counter-clockwise and&lt;/li&gt;
  &lt;li&gt;performing a bunch of inner products with each rotation of the convolving vector that we flipped (here we use $a$) with the second-argument vector  (here we use $x$ or $b$ in the examples).&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;img src=&quot;../../../../images/circular_convolution.svg&quot; alt=&quot;circular convolution&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Thus coordinate &lt;code class=&quot;highlighter-rouge&quot;&gt;k&lt;/code&gt; of the circular convolution $a \star x$ is the inner product of x with $a$ reversed and then rotated $k$ times.&lt;/p&gt;

&lt;p&gt;We implement this in a straightforward fashion, ignoring the fact that it isnt optimized:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;circular_convolution&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;l&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;For example, we get a new length-5 vector by convolving $a$ and $b$:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;circular_convolution&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;9.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;20.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;11.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;7.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;13.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;circular-convolution-is-multiplication-with-a-circulant-matrix&quot;&gt;Circular Convolution is Multiplication with a Circulant Matrix&lt;/h2&gt;

&lt;p&gt;The circulant matrix of a vector is built like this:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../../../images/circulant_shift.svg&quot; alt=&quot;create circulant&quot; /&gt;&lt;/p&gt;

&lt;p&gt;There is a &lt;a href=&quot;https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.circulant.html&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;scipy&lt;/code&gt; method&lt;/a&gt; for constructing them:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;scipy.linalg&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;circulant&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;C_a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;circulant&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;C_b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;circulant&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;C_a&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;C_b&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([[&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;To see how you can make a circulant matrix (again not optimized):&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;right_shift&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;shifted_v&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;shifted_v&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shifted_v&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;right_shift&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;4.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;3.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;custom_circulant&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;C_v&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;C_v&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# first column is just the vector
&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# next columns are each right/down-shifted
&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;C_v&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;right_shift&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;C_v&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;C_v&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;custom_circulant&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;4.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;3.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;4.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;3.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;4.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;3.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;3.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;4.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;4.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;3.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;An interesting fact is that circulant matrices commute:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;C_a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;@&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;C_b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;C_b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;@&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;C_a&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([[&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;C_a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;@&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;C_b&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([[&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;But now look, if $C_a$ is the circulant matrix built from $a$, &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;a \star x = C_a x&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.46528em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.43056em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.83333em;vertical-align:-0.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.07153em;&quot;&gt;C&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.151392em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;a&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;C_a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;@&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;circular_convolution&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Circular convolution is just multiplying by the circulant matrix and moreover (see the paper)
&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;a \star x = C_a x = C_x a = a \star x&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.46528em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.43056em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.83333em;vertical-align:-0.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.07153em;&quot;&gt;C&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.151392em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;a&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.83333em;vertical-align:-0.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.07153em;&quot;&gt;C&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.151392em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.46528em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.43056em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

&lt;h2 id=&quot;how-dft-is-related&quot;&gt;How DFT Is Related&lt;/h2&gt;

&lt;p&gt;Now lets use the numpy implementation of the discrete fourier transform:&lt;/p&gt;

&lt;p&gt;$\hat{a} = \mathrm{DFT}(a)$&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;a_hat&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fft&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fft&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;$\hat{b} = \mathrm{DFT}(b)$&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;b_hat&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fft&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fft&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;a_hat&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;10.&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;3.4409548j&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.81229924j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.81229924j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;3.4409548j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;b_hat&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;6.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2.35410197&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.36327126j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;4.35410197&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.53884177j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;4.35410197&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.53884177j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2.35410197&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.36327126j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now take the component-wise product of these DFTd vectors $\hat{a}$ and $\hat{b}$:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;hat_prod&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a_hat&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b_hat&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;hat_prod&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;60.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;4.63525492&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;9.00853662j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;12.13525492&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.3102707j&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;12.13525492&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.3102707j&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;4.63525492&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;9.00853662j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Now lets undo the DFT using the Inverse Discrete Fourier Transform:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fft&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ifft&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hat_prod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;9.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;20.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;11.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;7.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;13.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;So, $\mathrm{DFT}^{-1}(\hat{a} * \hat{b})$ was &lt;code class=&quot;highlighter-rouge&quot;&gt;[9, 20, 11, 7, 13]&lt;/code&gt; in our example, all real with no imaginary components.&lt;/p&gt;

&lt;p&gt;But wait a second:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;circular_convolution&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;9.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;20.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;11.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;7.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;13.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Cool!
&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;D&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;F&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mover accent=&quot;true&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;^&lt;/mo&gt;&lt;/mover&gt;&lt;mo&gt;&lt;/mo&gt;&lt;mover accent=&quot;true&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;^&lt;/mo&gt;&lt;/mover&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;\mathrm{DFT}^{-1}(\hat{a} * \hat{b}) = a \star b&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.137338em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathrm&quot;&gt;D&lt;/span&gt;&lt;span class=&quot;mord mathrm&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;mord mathrm&quot;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.887338em;&quot;&gt;&lt;span style=&quot;top:-3.1362300000000003em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord accent&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.69444em;&quot;&gt;&lt;span style=&quot;top:-3em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;accent-body&quot; style=&quot;left:-0.25em;&quot;&gt;^&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.2078799999999998em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord accent&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.9578799999999998em;&quot;&gt;&lt;span style=&quot;top:-3em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;b&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.26344em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;accent-body&quot; style=&quot;left:-0.25em;&quot;&gt;^&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.46528em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.69444em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;b&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

&lt;h2 id=&quot;how-does-this-work&quot;&gt;How Does This Work&lt;/h2&gt;

&lt;p&gt;Hopefully this notebook will interest you enough to dive into the source paper to find out why this trick works, but here are some of the details with examples.&lt;/p&gt;

&lt;p&gt;First iteresting fact: the DFT of a vector gives the same result as the eigenvalues of the circulant matrix for that vector.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fft&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fft&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;10.&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.j&lt;/span&gt;        &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;3.4409548j&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.81229924j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
           &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.81229924j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;3.4409548j&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;linalg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eigvals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;C_a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;10.&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.j&lt;/span&gt;        &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;3.4409548j&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;3.4409548j&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
           &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.81229924j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.81229924j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;custom_circulant&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;4.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;3.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;4.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;3.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;4.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;3.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;3.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;4.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;4.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;3.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Second interesting fact: the circulant matrices commute with the operator that rotates a circular vector. This is because this operator, the step matrix $S$, is itself a circulant matrix.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;step_matrix&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;circulant&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;step_matrix&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So it makes us step right/clockwise:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;step_matrix&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;@&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The adjoint of the step matrix $S^*$ is just the step in the other direction.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;step_matrix_adjoint&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;step_matrix&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;step_matrix_adjoint&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;step_matrix_adjoint&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;@&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Interesting fact 3: the step matrix is a fundamental example of a circulant matrix. If you look at the eigenvalues and eigenvectors of its adjoint, you recover the DFT as well as connection between the periodic domain and modular arithmetic used in the definition of the circular convolution.&lt;/p&gt;

&lt;p&gt;The eigenvalues of $S^*$:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;step_eigs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;linalg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eigvals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step_matrix_adjoint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;step_eigs&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.80901699&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.58778525j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.80901699&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.58778525j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;mf&quot;&gt;0.30901699&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.95105652j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;0.30901699&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.95105652j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.j&lt;/span&gt;        &lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It may be hard to see a pattern here, so lets plot them on the complex plane.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.patches&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Circle&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;fig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplots&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_ylim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_xlim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;circle&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Circle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;facecolor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'none'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;edgecolor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;linewidth&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;alpha&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_patch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;circle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scatter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;real&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step_eigs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;imag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step_eigs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;alpha&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;../../../../images/output_91_1.png&quot; alt=&quot;png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;These are the roots of unity. In this case, because we were looking at $n = 5$, they are the fifth-roots of unity: $\exp \left(\frac{i 2 \pi k}{5} \right)$ for $k = 0, 1, 2, 3, 4$.&lt;/p&gt;

&lt;p&gt;You can build a matrix with nice choices of eigenvectors of $S^*$:&lt;/p&gt;

&lt;span class=&quot;katex-display&quot;&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mo fence=&quot;true&quot;&gt;(&lt;/mo&gt;&lt;mtable rowspacing=&quot;0.15999999999999992em&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;mo lspace=&quot;0em&quot; rspace=&quot;0em&quot;&gt;&lt;/mo&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;mi&gt;&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;mo lspace=&quot;0em&quot; rspace=&quot;0em&quot;&gt;&lt;/mo&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msup&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;mo lspace=&quot;0em&quot; rspace=&quot;0em&quot;&gt;&lt;/mo&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&lt;/mi&gt;&lt;mpadded height=&quot;+0em&quot; voffset=&quot;0em&quot;&gt;&lt;mspace mathbackground=&quot;black&quot; width=&quot;0em&quot; height=&quot;1.5em&quot;&gt;&lt;/mspace&gt;&lt;/mpadded&gt;&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&lt;/mi&gt;&lt;mpadded height=&quot;+0em&quot; voffset=&quot;0em&quot;&gt;&lt;mspace mathbackground=&quot;black&quot; width=&quot;0em&quot; height=&quot;1.5em&quot;&gt;&lt;/mspace&gt;&lt;/mpadded&gt;&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&lt;/mi&gt;&lt;mpadded height=&quot;+0em&quot; voffset=&quot;0em&quot;&gt;&lt;mspace mathbackground=&quot;black&quot; width=&quot;0em&quot; height=&quot;1.5em&quot;&gt;&lt;/mspace&gt;&lt;/mpadded&gt;&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;mrow&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&lt;/mi&gt;&lt;mpadded height=&quot;+0em&quot; voffset=&quot;0em&quot;&gt;&lt;mspace mathbackground=&quot;black&quot; width=&quot;0em&quot; height=&quot;1.5em&quot;&gt;&lt;/mspace&gt;&lt;/mpadded&gt;&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;mo lspace=&quot;0em&quot; rspace=&quot;0em&quot;&gt;&lt;/mo&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo fence=&quot;true&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;\begin{pmatrix}
1 &amp;amp; 1 &amp;amp; 1 &amp;amp; \dots &amp;amp; 1 \\
1 &amp;amp; \rho &amp;amp; \rho^2 &amp;amp; \dots &amp;amp; \rho^{n-1} \\
1 &amp;amp; \rho^{2} &amp;amp; \rho^4 &amp;amp; \dots &amp;amp; \rho^{2(n-1)} \\
\vdots &amp;amp; \vdots &amp;amp; \vdots &amp;amp; &amp;amp; \vdots \\
1 &amp;amp; \rho^{n-1} &amp;amp; \rho^{2(n-1)} &amp;amp; \dots &amp;amp; \rho^{(n-1)(n-1)}
\end{pmatrix}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:6.756em;vertical-align:-3.1279999999999997em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;minner&quot;&gt;&lt;span class=&quot;mopen&quot;&gt;&lt;span class=&quot;delimsizing mult&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:3.550045em;&quot;&gt;&lt;span style=&quot;top:-0.7499750000000004em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.1550000000000002em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;delimsizinginner delim-size4&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-1.8999850000000005em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.1550000000000002em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;delimsizinginner delim-size4&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-2.4949950000000003em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.1550000000000002em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;delimsizinginner delim-size4&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.090005em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.1550000000000002em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;delimsizinginner delim-size4&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.6850150000000004em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.1550000000000002em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;delimsizinginner delim-size4&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-4.280025em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.1550000000000002em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;delimsizinginner delim-size4&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-4.3100249999999996em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.1550000000000002em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;delimsizinginner delim-size4&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-5.550045em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.1550000000000002em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;delimsizinginner delim-size4&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:3.050045em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mtable&quot;&gt;&lt;span class=&quot;col-align-c&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:3.6280000000000006em;&quot;&gt;&lt;span style=&quot;top:-6.475500000000001em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.6875em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-5.2755em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.6875em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-4.027500000000001em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.6875em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-2.167500000000001em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.6875em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;border-right-width:0em;border-top-width:1.5em;bottom:0em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-0.9195000000000004em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.6875em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:3.1279999999999997em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;arraycolsep&quot; style=&quot;width:0.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;arraycolsep&quot; style=&quot;width:0.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;col-align-c&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:3.6280000000000006em;&quot;&gt;&lt;span style=&quot;top:-6.475500000000001em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.6875em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-5.2755em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.6875em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-4.027500000000001em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.6875em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8141079999999999em;&quot;&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-2.167500000000001em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.6875em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;border-right-width:0em;border-top-width:1.5em;bottom:0em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-0.9195000000000004em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.6875em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8141079999999999em;&quot;&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;mbin mtight&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:3.1279999999999997em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;arraycolsep&quot; style=&quot;width:0.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;arraycolsep&quot; style=&quot;width:0.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;col-align-c&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:3.6280000000000006em;&quot;&gt;&lt;span style=&quot;top:-6.475500000000001em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.6875em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-5.2755em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.6875em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8141079999999999em;&quot;&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-4.027500000000001em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.6875em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8141079999999999em;&quot;&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;4&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-2.167500000000001em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.6875em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;border-right-width:0em;border-top-width:1.5em;bottom:0em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-0.9195000000000004em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.6875em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8879999999999999em;&quot;&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;mopen mtight&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;mbin mtight&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;mclose mtight&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:3.1279999999999997em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;arraycolsep&quot; style=&quot;width:0.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;arraycolsep&quot; style=&quot;width:0.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;col-align-c&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:3.6280000000000006em;&quot;&gt;&lt;span style=&quot;top:-6.288000000000001em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;minner&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-5.088em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;minner&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.8400000000000003em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;minner&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-1.9800000000000009em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-0.7320000000000004em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;minner&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:3.1279999999999997em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;arraycolsep&quot; style=&quot;width:0.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;arraycolsep&quot; style=&quot;width:0.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;col-align-c&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:3.6280000000000006em;&quot;&gt;&lt;span style=&quot;top:-6.475500000000001em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.6875em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-5.2755em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.6875em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8141079999999999em;&quot;&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;mbin mtight&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-4.027500000000001em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.6875em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8879999999999999em;&quot;&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;mopen mtight&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;mbin mtight&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;mclose mtight&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-2.167500000000001em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.6875em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;border-right-width:0em;border-top-width:1.5em;bottom:0em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-0.9195000000000004em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.6875em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8879999999999999em;&quot;&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mopen mtight&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;mbin mtight&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;mclose mtight&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mopen mtight&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;mbin mtight&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;mclose mtight&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:3.1279999999999997em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;&lt;span class=&quot;delimsizing mult&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:3.550045em;&quot;&gt;&lt;span style=&quot;top:-0.7499750000000004em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.1550000000000002em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;delimsizinginner delim-size4&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-1.8999850000000005em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.1550000000000002em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;delimsizinginner delim-size4&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-2.4949950000000003em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.1550000000000002em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;delimsizinginner delim-size4&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.090005em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.1550000000000002em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;delimsizinginner delim-size4&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.6850150000000004em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.1550000000000002em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;delimsizinginner delim-size4&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-4.280025em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.1550000000000002em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;delimsizinginner delim-size4&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-4.3100249999999996em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.1550000000000002em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;delimsizinginner delim-size4&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-5.550045em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.1550000000000002em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;delimsizinginner delim-size4&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:3.050045em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;

&lt;p&gt;where $\rho$ is the first root of unity. For example $\exp \left(\frac{i 2 \pi}{5} \right)$ for $n = 5$, the top root in that picture.&lt;/p&gt;

&lt;p&gt;First we make a way to grab the $n$-th roots:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;roots_of_unity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# returns solutions to: x^n - 1 = 0
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;coeffs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;coeffs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# x^n
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;coeffs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# - 1
&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;roots&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coeffs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Lets verify this by checking the $n$-th power of each of the roots:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;roots_of_unity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;roots_of_unity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.0000000000000007&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;3.885780586188048e-16j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
     &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.0000000000000007&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;3.885780586188048e-16j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
     &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.9999999999999993&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;For our example we want:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;fifth_roots&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;roots_of_unity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fifth_roots&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.80901699&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.58778525j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
         &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.80901699&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.58778525j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;mf&quot;&gt;0.30901699&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.95105652j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;mf&quot;&gt;0.30901699&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.95105652j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.j&lt;/span&gt;        &lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It can be helpful to view the real and complex parts separately especially when there are more than 3 significant digits. You can also set the precision displayed:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_printoptions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;precision&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;real&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fifth_roots&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.81&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.81&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;0.31&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;0.31&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;imag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fifth_roots&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.59&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.59&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;0.95&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.95&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now lets plot them to make sure they look right:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;fig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplots&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_ylim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_xlim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;circle&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Circle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;facecolor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'none'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;edgecolor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;linewidth&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;alpha&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_patch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;circle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scatter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;real&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fifth_roots&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;imag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fifth_roots&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;alpha&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;../../../../images/output_109_1.png&quot; alt=&quot;png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;So, the way it supplied roots was sort of out of order. We the one on the top which was at index 2:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;first_root&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fifth_roots&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;first_root&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.30901699437494734&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.9510565162951536j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;first_root&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;4.440892098500626e-16j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When checking equality of floats you can run into precision issues, so its nice to use &lt;code class=&quot;highlighter-rouge&quot;&gt;np.isclose()&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isclose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;first_root&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So it is indeed a fifth root.&lt;/p&gt;

&lt;p&gt;We want to show a relationship between the matrix of eigenvectors for the step matrix and DFT, but the default eigenvectors are not in quite the shape we want:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;W&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;linalg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step_matrix_adjoint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;W&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([[&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.14&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.43j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;0.14&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.43j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.36&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.26j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.36&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.26j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;0.45&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.j&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.14&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.43j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;0.14&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.43j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;0.14&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.43j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;0.14&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.43j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;0.45&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.j&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.36&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.26j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.36&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.26j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;0.45&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.j&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;0.45&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.j&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;0.45&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.j&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.45&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.j&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;0.45&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.j&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;0.14&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.43j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;0.14&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.43j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;0.45&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.j&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.36&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.26j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.36&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.26j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.36&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.26j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.36&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.26j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;0.45&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.j&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Which is why we need to do this work to get our desired form&lt;/p&gt;

&lt;span class=&quot;katex-display&quot;&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mo fence=&quot;true&quot;&gt;(&lt;/mo&gt;&lt;mtable rowspacing=&quot;0.15999999999999992em&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;mo lspace=&quot;0em&quot; rspace=&quot;0em&quot;&gt;&lt;/mo&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;mi&gt;&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;mo lspace=&quot;0em&quot; rspace=&quot;0em&quot;&gt;&lt;/mo&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msup&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;mo lspace=&quot;0em&quot; rspace=&quot;0em&quot;&gt;&lt;/mo&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&lt;/mi&gt;&lt;mpadded height=&quot;+0em&quot; voffset=&quot;0em&quot;&gt;&lt;mspace mathbackground=&quot;black&quot; width=&quot;0em&quot; height=&quot;1.5em&quot;&gt;&lt;/mspace&gt;&lt;/mpadded&gt;&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&lt;/mi&gt;&lt;mpadded height=&quot;+0em&quot; voffset=&quot;0em&quot;&gt;&lt;mspace mathbackground=&quot;black&quot; width=&quot;0em&quot; height=&quot;1.5em&quot;&gt;&lt;/mspace&gt;&lt;/mpadded&gt;&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&lt;/mi&gt;&lt;mpadded height=&quot;+0em&quot; voffset=&quot;0em&quot;&gt;&lt;mspace mathbackground=&quot;black&quot; width=&quot;0em&quot; height=&quot;1.5em&quot;&gt;&lt;/mspace&gt;&lt;/mpadded&gt;&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;mrow&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&lt;/mi&gt;&lt;mpadded height=&quot;+0em&quot; voffset=&quot;0em&quot;&gt;&lt;mspace mathbackground=&quot;black&quot; width=&quot;0em&quot; height=&quot;1.5em&quot;&gt;&lt;/mspace&gt;&lt;/mpadded&gt;&lt;/mi&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;mo lspace=&quot;0em&quot; rspace=&quot;0em&quot;&gt;&lt;/mo&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;false&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo fence=&quot;true&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;\begin{pmatrix}
1 &amp;amp; 1 &amp;amp; 1 &amp;amp; \dots &amp;amp; 1 \\
1 &amp;amp; \rho &amp;amp; \rho^2 &amp;amp; \dots &amp;amp; \rho^{n-1} \\
1 &amp;amp; \rho^{2} &amp;amp; \rho^4 &amp;amp; \dots &amp;amp; \rho^{2(n-1)} \\
\vdots &amp;amp; \vdots &amp;amp; \vdots &amp;amp; &amp;amp; \vdots \\
1 &amp;amp; \rho^{n-1} &amp;amp; \rho^{2(n-1)} &amp;amp; \dots &amp;amp; \rho^{(n-1)(n-1)}
\end{pmatrix}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:6.756em;vertical-align:-3.1279999999999997em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;minner&quot;&gt;&lt;span class=&quot;mopen&quot;&gt;&lt;span class=&quot;delimsizing mult&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:3.550045em;&quot;&gt;&lt;span style=&quot;top:-0.7499750000000004em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.1550000000000002em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;delimsizinginner delim-size4&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-1.8999850000000005em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.1550000000000002em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;delimsizinginner delim-size4&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-2.4949950000000003em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.1550000000000002em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;delimsizinginner delim-size4&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.090005em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.1550000000000002em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;delimsizinginner delim-size4&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.6850150000000004em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.1550000000000002em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;delimsizinginner delim-size4&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-4.280025em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.1550000000000002em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;delimsizinginner delim-size4&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-4.3100249999999996em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.1550000000000002em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;delimsizinginner delim-size4&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-5.550045em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.1550000000000002em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;delimsizinginner delim-size4&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:3.050045em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mtable&quot;&gt;&lt;span class=&quot;col-align-c&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:3.6280000000000006em;&quot;&gt;&lt;span style=&quot;top:-6.475500000000001em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.6875em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-5.2755em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.6875em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-4.027500000000001em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.6875em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-2.167500000000001em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.6875em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;border-right-width:0em;border-top-width:1.5em;bottom:0em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-0.9195000000000004em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.6875em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:3.1279999999999997em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;arraycolsep&quot; style=&quot;width:0.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;arraycolsep&quot; style=&quot;width:0.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;col-align-c&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:3.6280000000000006em;&quot;&gt;&lt;span style=&quot;top:-6.475500000000001em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.6875em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-5.2755em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.6875em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-4.027500000000001em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.6875em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8141079999999999em;&quot;&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-2.167500000000001em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.6875em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;border-right-width:0em;border-top-width:1.5em;bottom:0em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-0.9195000000000004em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.6875em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8141079999999999em;&quot;&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;mbin mtight&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:3.1279999999999997em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;arraycolsep&quot; style=&quot;width:0.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;arraycolsep&quot; style=&quot;width:0.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;col-align-c&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:3.6280000000000006em;&quot;&gt;&lt;span style=&quot;top:-6.475500000000001em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.6875em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-5.2755em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.6875em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8141079999999999em;&quot;&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-4.027500000000001em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.6875em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8141079999999999em;&quot;&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;4&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-2.167500000000001em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.6875em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;border-right-width:0em;border-top-width:1.5em;bottom:0em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-0.9195000000000004em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.6875em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8879999999999999em;&quot;&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;mopen mtight&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;mbin mtight&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;mclose mtight&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:3.1279999999999997em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;arraycolsep&quot; style=&quot;width:0.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;arraycolsep&quot; style=&quot;width:0.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;col-align-c&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:3.6280000000000006em;&quot;&gt;&lt;span style=&quot;top:-6.288000000000001em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;minner&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-5.088em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;minner&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.8400000000000003em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;minner&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-1.9800000000000009em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-0.7320000000000004em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;minner&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:3.1279999999999997em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;arraycolsep&quot; style=&quot;width:0.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;arraycolsep&quot; style=&quot;width:0.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;col-align-c&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:3.6280000000000006em;&quot;&gt;&lt;span style=&quot;top:-6.475500000000001em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.6875em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-5.2755em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.6875em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8141079999999999em;&quot;&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;mbin mtight&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-4.027500000000001em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.6875em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8879999999999999em;&quot;&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;mopen mtight&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;mbin mtight&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;mclose mtight&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-2.167500000000001em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.6875em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;border-right-width:0em;border-top-width:1.5em;bottom:0em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-0.9195000000000004em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.6875em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8879999999999999em;&quot;&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mopen mtight&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;mbin mtight&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;mclose mtight&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mopen mtight&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;mbin mtight&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;mclose mtight&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:3.1279999999999997em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;&lt;span class=&quot;delimsizing mult&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:3.550045em;&quot;&gt;&lt;span style=&quot;top:-0.7499750000000004em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.1550000000000002em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;delimsizinginner delim-size4&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-1.8999850000000005em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.1550000000000002em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;delimsizinginner delim-size4&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-2.4949950000000003em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.1550000000000002em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;delimsizinginner delim-size4&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.090005em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.1550000000000002em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;delimsizinginner delim-size4&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.6850150000000004em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.1550000000000002em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;delimsizinginner delim-size4&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-4.280025em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.1550000000000002em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;delimsizinginner delim-size4&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-4.3100249999999996em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.1550000000000002em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;delimsizinginner delim-size4&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-5.550045em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.1550000000000002em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;delimsizinginner delim-size4&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:3.050045em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;

&lt;p&gt;So the powers (mod n) are:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;root_power&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;power&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;root_power&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;power&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;root_power&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;3.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;4.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;4.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;3.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;3.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;4.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;4.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;3.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;For 5 this is a bit boring because its prime, but for 4:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;root_power&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;power&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;root_power&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;power&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;root_power&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;3.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;3.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now we use the first root of unity and raise it to the desired powers to create the matrix of eigenvectors in the nice form:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# might have to do this to get around an error where things are squashed to real parts
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;W&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step_matrix_adjoint&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;complex_&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;power&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;W&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;first_root&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;power&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;W&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([[&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.j&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.j&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.j&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.j&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.j&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.j&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;0.31&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.95j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.81&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.59j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.81&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.59j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;0.31&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.95j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.j&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.81&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.59j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;0.31&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.95j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;0.31&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.95j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.81&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.59j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.j&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.81&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.59j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;0.31&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.95j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;0.31&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.95j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.81&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.59j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.j&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;0.31&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.95j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.81&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.59j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.81&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.59j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;0.31&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.95j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Remembering the first root, we see this looks right.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;first_root&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.30901699437494734&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.9510565162951536j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You can compute the adjoint (transpose and complex conjugate) with:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;W_adjoint&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;W&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;conj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The next interesting fact to think about is (5.1):
&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;d&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mover accent=&quot;true&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;^&lt;/mo&gt;&lt;/mover&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;C_a W = W \mathrm{diag}(\hat{a})&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.83333em;vertical-align:-0.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.07153em;&quot;&gt;C&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.151392em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;a&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;W&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;W&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathrm&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;mord mathrm&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mord mathrm&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mord mathrm&quot; style=&quot;margin-right:0.01389em;&quot;&gt;g&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord accent&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.69444em;&quot;&gt;&lt;span style=&quot;top:-3em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;accent-body&quot; style=&quot;left:-0.25em;&quot;&gt;^&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;Create the a diagonal matrix with the entries of $\hat{a}$&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;diag_a_hat&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;diag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a_hat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isclose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;C_a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;@&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;W&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;W&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;@&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;diag_a_hat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([[&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;summary&quot;&gt;Summary&lt;/h2&gt;

&lt;p&gt;What this is saying is that $W$ also provided eigenvectors for $C_a$ and they have eigenvalues from $\mathrm{DFT}(a) = \hat{a}$. This nice matrix not only diagonalizes $S^&lt;em&gt;$ but it also diagonalizes *all circulant matrices simultaneously&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;This means we can compute DFTs of length $n$ just by knowing the n-th root of unity! (5.2) re-written:
&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;D&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mover accent=&quot;true&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;^&lt;/mo&gt;&lt;/mover&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mfrac&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mo&gt;&lt;/mo&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;\mathrm{Diag}(\hat{a}) = W^{-1} C_a W = \frac 1n W^* C_a W&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathrm&quot;&gt;D&lt;/span&gt;&lt;span class=&quot;mord mathrm&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mord mathrm&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;mord mathrm&quot; style=&quot;margin-right:0.01389em;&quot;&gt;g&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord accent&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.69444em;&quot;&gt;&lt;span style=&quot;top:-3em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot;&gt;a&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;accent-body&quot; style=&quot;left:-0.25em;&quot;&gt;^&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.964108em;vertical-align:-0.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;W&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8141079999999999em;&quot;&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.07153em;&quot;&gt;C&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.151392em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;a&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;W&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.190108em;vertical-align:-0.345em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.845108em;&quot;&gt;&lt;span style=&quot;top:-2.6550000000000002em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;n&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.23em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;frac-line&quot; style=&quot;border-bottom-width:0.04em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.394em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.345em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;W&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.688696em;&quot;&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mbin mtight&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.07153em;&quot;&gt;C&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.151392em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathdefault mtight&quot;&gt;a&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord mathdefault&quot; style=&quot;margin-right:0.13889em;&quot;&gt;W&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;But the point of (5.2) is circular convolution of x with a is just:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;Take the DFT of x, using multiplication with the adjoint of a nice matrix of eigenvectors of the simple left-shift matrix ($S^*$):&lt;/p&gt;

    &lt;p&gt;$W^* x$&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Entry-wise multiplication with this result by the DFT of $a$ ($\hat{a}$):&lt;/p&gt;

    &lt;p&gt;$\mathrm{Diag}(\hat{a}) W^* x$&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Multiply this result by the inverse of the nice adjoint:&lt;/p&gt;

    &lt;p&gt;$\frac 1n W \mathrm{Diag}(\hat{a}) W^* x$&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;This is cool because not only do we see that DFT naturally comes from looking at shift-invariant transformations but we also have a way of understanding circular convolutions:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;$a \star x = x \star a = C_a x = C_x a = \mathrm{DFT}^{-1} ( \hat{x} \circ \hat{a})$&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This last one is especially interesting, convolution is the time-domain equivalent of simple component-wise multiplication in the frequency domain.&lt;/p&gt;</content><author><name></name></author><summary type="html">Circulant Matrices and the Discrete Fourier Transform</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://simonstolarczyk.com/images/circulant_ex_1.svg" /><media:content medium="image" url="http://simonstolarczyk.com/images/circulant_ex_1.svg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Make More Interesting Random Music</title><link href="http://simonstolarczyk.com/markdown/2020/08/02/Python_and_MIDI_2.html" rel="alternate" type="text/html" title="Make More Interesting Random Music" /><published>2020-08-02T00:00:00-05:00</published><updated>2020-08-02T00:00:00-05:00</updated><id>http://simonstolarczyk.com/markdown/2020/08/02/Python_and_MIDI_2</id><content type="html" xml:base="http://simonstolarczyk.com/markdown/2020/08/02/Python_and_MIDI_2.html">&lt;h1 id=&quot;make-more-interesting-random-music&quot;&gt;Make More Interesting Random Music&lt;/h1&gt;

&lt;p&gt;We saw last time that it is simple to construct a MIDI file with the &lt;code class=&quot;highlighter-rouge&quot;&gt;pretty_midi&lt;/code&gt; package. Now to make something a little more musically interesting than alternating between two notes we need to randomly generate notes to play using some basic music theory to make things sound good. To do this we will:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;choose a scale&lt;/li&gt;
  &lt;li&gt;find all of the midi notes attached to that scale&lt;/li&gt;
  &lt;li&gt;randomly draw notes from that collection of midi notes&lt;/li&gt;
  &lt;li&gt;get a pleasing collection of simple chords to accompany the melody&lt;/li&gt;
  &lt;li&gt;vary the rhythm of the melody&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;pick-a-scale&quot;&gt;Pick a Scale&lt;/h2&gt;

&lt;p&gt;First we use a couple of nice utilities of &lt;code class=&quot;highlighter-rouge&quot;&gt;pretty_midi&lt;/code&gt;, a method which takes an integer and spits out one of the major and minor keys and another method which takes that same integer and returns how many accidentals the key has. Using the key name we can determine whether the key has flat accidentals or sharp accidentals and then by using the fact that accidentals accumulate (if a key has a G# then it also has a C#, for example) we can easily identify which notes are in the key.&lt;/p&gt;

&lt;p&gt;To say more, we are using the fact that the Major and Minor keys have certain nice patterns. If we start from C and move up in perfect 5ths (C, G, D, A) then those corresponding (major) keys each add an accidental:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;C Major: CDEFGAB&lt;/li&gt;
  &lt;li&gt;G Major: GABCDEF#&lt;/li&gt;
  &lt;li&gt;D Major: DEF#GABC#&lt;/li&gt;
  &lt;li&gt;A Major: ABC#DEF#G#&lt;/li&gt;
  &lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This means we know the exact notes that are made sharp or (flat) if we know if the key is sharp (flat) and how many accidentals there are, we do not even need to know the root: we are being told the same information in a different way. Now, there is actually a more insightful way to do this (how making major scales is normally taught) by using the fact that you start at the root and add notes with the pattern WWHWWWH, but it was fun to think of a different way to get the notes.&lt;/p&gt;

&lt;p&gt;We return the &lt;code class=&quot;highlighter-rouge&quot;&gt;key_notes&lt;/code&gt; which runs from C to B because this is how the MIDI format is laid out for each octave ( B1 C2 C#2  A#2 B2 C3 ), but we also save off the notes of the key starting from the root for (optional) printing to the user as &lt;code class=&quot;highlighter-rouge&quot;&gt;scale_notes&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;note_names&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'CDEFGAB'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sharp_accidentals&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'FCGDAEB'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flat_accidentals&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'BEADGCF'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;determine_key_notes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key_number&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;key_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pretty_midi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key_number_to_key_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key_number&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_accidentals&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pretty_midi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key_number_to_mode_accidentals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key_number&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;root&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;key_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;root_index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;note_names&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;root&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;key_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;b&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;accidental_mark&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'b'&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;accidentals&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flat_accidentals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_accidentals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;accidental_mark&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'#'&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;accidentals&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sharp_accidentals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_accidentals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;key_notes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;accidental_mark&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;accidentals&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;note_names&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;scale_notes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key_notes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;key_notes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;root_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;root_index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;find-all-midi-notes-given-key-notes&quot;&gt;Find All MIDI Notes Given Key Notes&lt;/h2&gt;

&lt;p&gt;For this, use the &lt;code class=&quot;highlighter-rouge&quot;&gt;pretty_midi&lt;/code&gt; utility that converts note names to MIDI note numbers and apply it to all the note names with all the octave numbers attached.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get_all_midi_numbers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;note_names&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;midi_numbers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;note_names&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;note_names&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# simple de-dup
&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;octave&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;note&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;note_names&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;midi_number&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pretty_midi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;note_name_to_number&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;note&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;octave&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;midi_numbers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;midi_number&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;sorted&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;midi_numbers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We do not need to de-duplicate or sort for our current use, but I added those steps in case I supply some note names out of order (&lt;code class=&quot;highlighter-rouge&quot;&gt;[D, C]&lt;/code&gt; instead of &lt;code class=&quot;highlighter-rouge&quot;&gt;[C, D]&lt;/code&gt; for instance) or provide possible note duplicates for other uses.&lt;/p&gt;

&lt;h2 id=&quot;randomly-draw-notes&quot;&gt;Randomly Draw Notes&lt;/h2&gt;

&lt;p&gt;Here you can now use the collection of midi notes and just make a random choice from it at each step. For instance if &lt;code class=&quot;highlighter-rouge&quot;&gt;g_maj_midi&lt;/code&gt; is the collection of MIDI notes for G Major then you can randomly select one with &lt;code class=&quot;highlighter-rouge&quot;&gt;pitch = random.choice(g_maj_midi[21:36])&lt;/code&gt; where we take a slice of the array to restrict the notes to just a couple of octaves.&lt;/p&gt;

&lt;h2 id=&quot;chord-accompaniment&quot;&gt;Chord Accompaniment&lt;/h2&gt;

&lt;p&gt;We want to get just simple chords from the major scale for the piano to play them for whole notes. There are some existing Python packages that can be used:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/Miserlou/chords2midi&quot;&gt;chords2midi&lt;/a&gt; lets you generate a MIDI file by supplying a progressing an a key: &lt;code class=&quot;highlighter-rouge&quot;&gt;c2m I V vi IV --key C&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;chords2midi&lt;/code&gt; uses &lt;a href=&quot;https://github.com/yuma-m/pychord&quot;&gt;pychord&lt;/a&gt;, which will generate the component notes of a chord from its name as well as name a chord from its notes.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;These are both strong utilities that I will certainly use as I expand but for now I will do something much simpler. You can get a major scale chord progression by simply going to the scale and taking a note for the root and getting the third and fifth of a triad by just taking the second and fourth notes after your root. For instance, you can get a C (major) triad from the C major scale by looking at the scale CDEFGAB and using that pattern C_E_G__. Whether this is major or minor is irrelevant for our use: we just want to grab all the simple triads (not worrying about inversions or anything) and collect them together for one octave of root notes:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get_major_progression&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;root_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;midi_numbers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;chords&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;chord_root_index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;root_index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;chord_third_index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chord_root_index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;chord_fifth_index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chord_root_index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;root&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;midi_numbers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chord_root_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;third&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;midi_numbers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chord_third_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;fifth&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;midi_numbers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chord_fifth_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;chord&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;root&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;third&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fifth&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;chords&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chord&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chords&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This will generate a list of chord lists, where each chord list is the midi notes for a given triad. Note, if you do not feed the notes of a key as the MIDI numbers you will not get a major key progression, so this might be imperfectly named.&lt;/p&gt;

&lt;h2 id=&quot;vary-the-rhythm&quot;&gt;Vary the Rhythm&lt;/h2&gt;

&lt;p&gt;When we were adding notes one at a time we were keeping track of when the note began and when it ended in seconds. It would be nice to forget about when they begin and imagine writing the song and moving forward, adding notes now. To do this we make a writer for our instrument that keeps track of when now is and allows us to add notes one at a time, as a chord, or in a chunk of notes. Using this chunking allows us to vary the rhythm, we can randomly determine how long the next note(s) should be and then play a bunch of notes of that length. This is slightly more natural than varying each note independently, because shorter notes are often grouped together.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Writer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;instrument&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;position&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;instrument&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;instrument&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;add_note&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pitch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;move_forward&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;note&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pretty_midi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Note&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;velocity&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pitch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pitch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;position&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;position&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;instrument&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;notes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;note&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;move_forward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;position&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;length&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;add_note_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pitches&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pitch&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pitches&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_note&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pitch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;add_chord&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pitches&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;move_forward&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pitch&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pitches&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_note&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pitch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;move_forward&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;move_forward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;position&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;length&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We leave &lt;code class=&quot;highlighter-rouge&quot;&gt;move_forward&lt;/code&gt; as an optional argument, because if we are writing notes that will occur at the same time (to form a chord) then we want the Writer head or position to stay at the same spot until we are done adding notes to that point in time. There are other simplifications that are made (no velocity changes), but this simple class gives us a lot of power so that we can more expressively generate midi music.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pretty_midi&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;music_info&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;determine_key_notes&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;music_info&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;random&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create a PrettyMIDI object
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ensemble&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pretty_midi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;PrettyMIDI&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create an Instrument instance for a cello instrument
# Changed to a guitar for my song, and was lazy about changing variable names
# cello_program = pretty_midi.instrument_name_to_program('Cello')
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cello_program&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pretty_midi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;instrument_name_to_program&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Overdriven Guitar'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cello&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pretty_midi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Instrument&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;program&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cello_program&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# do the same for a piano
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;piano_program&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pretty_midi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;instrument_name_to_program&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Acoustic Grand Piano'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;piano&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pretty_midi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Instrument&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;program&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;piano_program&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Add the instruments to the PrettyMIDI object
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ensemble&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;instruments&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cello&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ensemble&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;instruments&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;piano&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# here is where I put the Writer class from above
&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;piano_writer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Writer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;piano&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cello_writer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Writer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cello&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;song_length_in_seconds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;bpm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;120&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;beat_length&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bpm&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;num_beats&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;song_length_in_seconds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;beat_length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Decided on G major, which is index 7
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;g_maj&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;music_info&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;determine_key_notes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;g_maj_midi&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;music_info&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_all_midi_numbers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;g_maj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;root_number&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pretty_midi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;note_name_to_number&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;G4&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;root_index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;g_maj_midi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;root_number&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;major_progression&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;music_info&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_major_progression&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;root_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;g_maj_midi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;accompaniment_writer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;piano_writer&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;solo_writer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cello_writer&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# now we see the power of the writer object
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;accompaniment_writer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;position&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;song_length_in_seconds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;length&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;beat_length&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# whole note chords
&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# choose a random chord from the progression
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;chord&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;choice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;major_progression&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  

    &lt;span class=&quot;c1&quot;&gt;# add a lower octave of the notes for fullness
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;larger_chord&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chord&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chord&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# write the chord
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;accompaniment_writer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_chord&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;larger_chord&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;solo_writer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;position&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;song_length_in_seconds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# choose to play 16th, 8th, quarter, half, or whole note(s)
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;division&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;choice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;length&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;beat_length&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;division&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# if we chose 16th or 8th, play multiple of them
&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;division&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;num_notes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;division&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;pitches&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;choices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;g_maj_midi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;36&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_notes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;solo_writer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_note_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pitches&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;pitch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;choice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;g_maj_midi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;36&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;solo_writer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_note&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pitch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;beat_length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;write_song&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Write out the MIDI data
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;ensemble&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'duo.mid'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now with this I created the following &lt;a href=&quot;https://soundcloud.com/simon-stolarczyk/duo&quot;&gt;simple duet&lt;/a&gt;. It isnt the most thrilling piece of music, but with relatively simple rules behind it, I think it is interesting how complex it sounds.&lt;/p&gt;</content><author><name></name></author><summary type="html">Make More Interesting Random Music</summary></entry><entry><title type="html">Making Music with pretty_midi</title><link href="http://simonstolarczyk.com/markdown/2020/08/01/Python_and_MIDI.html" rel="alternate" type="text/html" title="Making Music with pretty_midi" /><published>2020-08-01T00:00:00-05:00</published><updated>2020-08-01T00:00:00-05:00</updated><id>http://simonstolarczyk.com/markdown/2020/08/01/Python_and_MIDI</id><content type="html" xml:base="http://simonstolarczyk.com/markdown/2020/08/01/Python_and_MIDI.html">&lt;h1 id=&quot;making-music-with-pretty_midi&quot;&gt;Making Music with pretty_midi&lt;/h1&gt;

&lt;h2 id=&quot;midi-music&quot;&gt;MIDI Music&lt;/h2&gt;

&lt;p&gt;A while back, when I was first learning Python, a friend and I made a program that generated random music by iterating through a song one note at a time randomly picking the note length and pitch for the notes with increasingly strict rules. My friend figured out how to use &lt;a href=&quot;https://pypi.org/project/MIDIUtil/&quot;&gt;MIDIUtil&lt;/a&gt; to create a midi file by writing down a sequence of note events, where each event says something about:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;velocity - how loud the note should be played&lt;/li&gt;
  &lt;li&gt;pitch - an integer value for telling a midi play what frequency to play&lt;/li&gt;
  &lt;li&gt;note start - when the note should start playing&lt;/li&gt;
  &lt;li&gt;note end - when it should stop&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;You can do a lot of music with just that information, and if you make simple choices for notes, with the right MIDI player you can get surprisingly listenable music. I have wanted to expand on this program for a while in various ways:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;generating music by applying machine learning techniques to various collections of midi files (like this &lt;a href=&quot;https://www.google.com/doodles/celebrating-johann-sebastian-bach&quot;&gt;Google Bach doodle&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;making something more interactive (something involving the console where you can add motifs and ideas on the play and have them played back)&lt;/li&gt;
  &lt;li&gt;feed the program just a text file with a simplistic music notation to easily create ideas that can get more complex (like &lt;a href=&quot;https://tidalcycles.org/index.php/Welcome&quot;&gt;TidalCycles&lt;/a&gt; which uses Haskell and SuperCollider).&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;creating-midi-files-with-python&quot;&gt;Creating MIDI Files with Python&lt;/h2&gt;

&lt;p&gt;I searched around on pypi a bit and found a promising package to start writing MIDI files with: &lt;a href=&quot;https://pypi.org/project/pretty_midi/&quot;&gt;pretty_midi&lt;/a&gt;. Its a &lt;a href=&quot;https://github.com/craffel/pretty-midi&quot;&gt;project on GitHub&lt;/a&gt; that seems to still be active (part of why I am not just using MIDIUtil again is that I remember I slightly annoying setup and it seems to be inactive). After a simple install, and running the second example &lt;a href=&quot;http://craffel.github.io/pretty-midi/&quot;&gt;from the documentation&lt;/a&gt; I found that it easily generated pleasing sounds that (after a bit of fitzing) I could simply listen to with VLC Media Player. Before I just imported the files into Reaper where I could use a custom VST, but this makes iterating a bit quicker.&lt;/p&gt;

&lt;p&gt;Here is an example I made where two instruments are playing a very minimalist piece:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pretty_midi&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create a PrettyMIDI object
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ensemble&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pretty_midi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;PrettyMIDI&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create an Instrument instance for a cello instrument
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cello_program&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pretty_midi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;instrument_name_to_program&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Cello'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cello&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pretty_midi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Instrument&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;program&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cello_program&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# do the same for a piano
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;piano_program&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pretty_midi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;instrument_name_to_program&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Acoustic Grand Piano'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;piano&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pretty_midi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Instrument&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;program&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;piano_program&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Add the instruments to the PrettyMIDI object
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ensemble&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;instruments&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cello&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ensemble&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;instruments&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;piano&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;song_length_in_seconds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;bpm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;120&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;beat_length&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bpm&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;num_beats&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;song_length_in_seconds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;beat_length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;beat&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_beats&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;beat&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;note_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'C5'&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;note_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'D5'&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;note_number&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pretty_midi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;note_name_to_number&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;note_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;note_start&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;beat&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;beat_length&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;note_end&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;note_start&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;beat_length&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;note&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pretty_midi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Note&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;velocity&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pitch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;note_number&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;note_start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;note_end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;cello&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;notes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;note&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;piano&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;notes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;note&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;write_song&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Write out the MIDI data
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;ensemble&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'ensemble.mid'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__name__&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;__main__&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;write_song&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This is a simple example, yet it shows the basics of the process that I will expand on:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;add notes one at a time&lt;/li&gt;
  &lt;li&gt;incorporate some randomness into the note properties (here pitch changes deterministically, but that will soon change)&lt;/li&gt;
  &lt;li&gt;using multiple instruments&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;I will begin to add to this, hopefully reaching what we achieved during my first experience with Python and MIDI and then think about ways to expand it and then start to apply some of my fastbook reading to it.&lt;/p&gt;</content><author><name></name></author><summary type="html">Making Music with pretty_midi</summary></entry><entry><title type="html">DataPlox</title><link href="http://simonstolarczyk.com/markdown/2020/07/23/data_objects.html" rel="alternate" type="text/html" title="DataPlox" /><published>2020-07-23T00:00:00-05:00</published><updated>2020-07-23T00:00:00-05:00</updated><id>http://simonstolarczyk.com/markdown/2020/07/23/data_objects</id><content type="html" xml:base="http://simonstolarczyk.com/markdown/2020/07/23/data_objects.html">&lt;h1 id=&quot;dataplox&quot;&gt;DataPlox&lt;/h1&gt;

&lt;p&gt;In understanding how to properly feed young, growing models, it is useful to know some of the main data objects in PyTorch and fastai. Fastai extends many of the fundamental PyTorch objects. Heres the picture that I have in my head:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../../../images/dataobjects.png&quot; alt=&quot;The relationships between important data objects.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;For the main PyTorch data classes:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://pytorch.org/docs/stable/data.html#torch.utils.data.Dataset&quot;&gt;Dataset&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader&quot;&gt;DataLoader&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The fastai library extends them with:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://dev.fast.ai/data.core#Datasets&quot;&gt;Datasets&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://dev.fast.ai/data.core#DataLoaders&quot;&gt;DataLoaders&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;and adds a useful class which can help construct the others:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://dev.fast.ai/data.block#DataBlock&quot;&gt;DataBlock&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;datablock&quot;&gt;DataBlock&lt;/h1&gt;

&lt;p&gt;This is a fastai object &lt;a href=&quot;http://dev.fast.ai/data.block&quot;&gt;which helps you build Datasets and DataLoaders&lt;/a&gt;. In addition to Chapter 6 of the fastbook, there is also &lt;a href=&quot;http://dev.fast.ai/tutorial.datablock&quot;&gt;a tutorial in the fastai docs&lt;/a&gt;. A DataBlock is a blueprint for how to build your data. You tell it:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;what kind of data you have (&lt;code class=&quot;highlighter-rouge&quot;&gt;blocks=&lt;/code&gt;),&lt;/li&gt;
  &lt;li&gt;how to get the input data (&lt;code class=&quot;highlighter-rouge&quot;&gt;get_x=&lt;/code&gt; or &lt;code class=&quot;highlighter-rouge&quot;&gt;get_items=&lt;/code&gt;),&lt;/li&gt;
  &lt;li&gt;how to get the targets/labels (&lt;code class=&quot;highlighter-rouge&quot;&gt;get_y&lt;/code&gt;),&lt;/li&gt;
  &lt;li&gt;how to perform the train/validation split (&lt;code class=&quot;highlighter-rouge&quot;&gt;splitter=&lt;/code&gt;),&lt;/li&gt;
  &lt;li&gt;as well as any resizing (&lt;code class=&quot;highlighter-rouge&quot;&gt;items_tfms=&lt;/code&gt;) or augmentations you want to be performed (&lt;code class=&quot;highlighter-rouge&quot;&gt;batch_tfms&lt;/code&gt;).&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;By feeding these blue prints a source (like a directory on your computer), you can use a DataBlock to create a Datasets or DataLoaders object.&lt;/p&gt;

&lt;h1 id=&quot;dataset&quot;&gt;Dataset&lt;/h1&gt;

&lt;p&gt;Dataset is a Torch object. We can find out exactly what a Dataset is because PyTorch is open source. We just have to be brave enough to parse some of the grittier implementation details.&lt;/p&gt;

&lt;p&gt;According to &lt;a href=&quot;https://pytorch.org/docs/stable/_modules/torch/utils/data/dataset.html#Dataset&quot;&gt;the source code&lt;/a&gt; a Dataset is at its core something that allows you to grab an item if you provide the index/key for it and that you can also add items to. This is just the abstract class definition, essentially the bare bones of a what a dataset should be. If you try to make a class that inherits from &lt;code class=&quot;highlighter-rouge&quot;&gt;Dataset&lt;/code&gt; you will get an error if you do not implement &lt;code class=&quot;highlighter-rouge&quot;&gt;__getitem__&lt;/code&gt;, the method for grabbing items. It does this by setting the default behavior of that method to raise a &lt;code class=&quot;highlighter-rouge&quot;&gt;NotImplementedError&lt;/code&gt;. You can also implement this behavior (forcing inheriting classes to define specific methods) by using the &lt;a href=&quot;https://docs.python.org/3/library/abc.html&quot;&gt;abc package&lt;/a&gt;. The source code also mentions that it would have set a default for a length function, but the standard methods for making a default that is forced to change have conflicts with what a length function is supposed to do.&lt;/p&gt;

&lt;p&gt;The types of Datasets are:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;IterableDataset&lt;/li&gt;
  &lt;li&gt;TensorDataset&lt;/li&gt;
  &lt;li&gt;ConcatDataset&lt;/li&gt;
  &lt;li&gt;ChainDataset&lt;/li&gt;
  &lt;li&gt;Subset&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;datasets&quot;&gt;Datasets&lt;/h1&gt;

&lt;p&gt;Datasets is an object that contains a training Dataset and a validation Dataset. You can generally construct a Datasets object from a DataBlock like this:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;dblock&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DataBlock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blue_print_details&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dsets&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dblock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;datasets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;dataloader&quot;&gt;DataLoader&lt;/h1&gt;

&lt;p&gt;A DataLoader is a Dataset together with a Sampler. A Sampler is a way to create an iterator out of your Dataset, so you can do things like consume data in batches as needed. Rather than take a Dataset an manually loop through chunks of it, at each step using a chunk to update a model, a DataLoader bundles this idea together. This makes a lot of sense to encapsulate: going through your data in batches is a frequently encountered process in machine learning!&lt;/p&gt;

&lt;p&gt;We can see &lt;a href=&quot;https://pytorch.org/docs/stable/_modules/torch/utils/data/sampler.html#Sampler&quot;&gt;from the source code&lt;/a&gt; that a Sampler is at minimum:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;a way to iterate over indices of dataset elements (&lt;code class=&quot;highlighter-rouge&quot;&gt;__iter__&lt;/code&gt;) and&lt;/li&gt;
  &lt;li&gt;a way to calculate the size of the returned iterators (&lt;code class=&quot;highlighter-rouge&quot;&gt;__len__&lt;/code&gt;).&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Just like with &lt;code class=&quot;highlighter-rouge&quot;&gt;DataSet&lt;/code&gt;, defining the length method is not strictly enforced by the interpreter because the various &lt;code class=&quot;highlighter-rouge&quot;&gt;NotImplemented&lt;/code&gt; errors you can throw do not quite work.`&lt;/p&gt;

&lt;p&gt;The kinds of samplers:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;SequentialSampler&lt;/code&gt; - go in direct 0, 1, 2,  order.&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;RandomSampler&lt;/code&gt; - randomly choose observations, with or without replacement (&lt;code class=&quot;highlighter-rouge&quot;&gt;replacement=&lt;/code&gt;)&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;SubsetRandomSampler&lt;/code&gt; - randomly sample from a provided subset of indices, without replacement&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;WeightedRandomSampler&lt;/code&gt; - for non-uniform random sampling&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;BatchSampler&lt;/code&gt; - generate mini-batches of indices&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;For DataLoader, the &lt;a href=&quot;https://pytorch.org/docs/stable/_modules/torch/utils/data/dataloader.html#DataLoader&quot;&gt;definition is a bit more involved&lt;/a&gt;. In part, because it implements multiprocessing, but it also does things like creating a Sampler from the arguments if one wasnt provided.&lt;/p&gt;

&lt;h1 id=&quot;dataloaders&quot;&gt;DataLoaders&lt;/h1&gt;

&lt;p&gt;DataLoaders is an object that contains a training DataLoader and a validation DataLoader. You can construct a DataLoaders from a DataBlock similarly to the Datasets method:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;dblock&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DataBlock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blue_print_details&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dls&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dblock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dataloaders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name></name></author><summary type="html">DataPlox</summary></entry><entry><title type="html">FastBook Chapter 5 Thoughts</title><link href="http://simonstolarczyk.com/markdown/2020/07/21/fastbook_ch5.html" rel="alternate" type="text/html" title="FastBook Chapter 5 Thoughts" /><published>2020-07-21T00:00:00-05:00</published><updated>2020-07-21T00:00:00-05:00</updated><id>http://simonstolarczyk.com/markdown/2020/07/21/fastbook_ch5</id><content type="html" xml:base="http://simonstolarczyk.com/markdown/2020/07/21/fastbook_ch5.html">&lt;h1 id=&quot;fastbook-chapter-5-thoughts&quot;&gt;FastBook Chapter 5 Thoughts&lt;/h1&gt;

&lt;p&gt;After reading the first half of chapter 3 (will read the second half this week) and (mostly) breezing through Chapter 4 (it contained a lot of familiar material), I worked on Chapter 5 this weekend.&lt;/p&gt;

&lt;h2 id=&quot;import-concepts&quot;&gt;Import concepts:&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Presizing.&lt;/li&gt;
  &lt;li&gt;Checking your DataBlock before you begin training&lt;/li&gt;
  &lt;li&gt;Train early (get a reasonable MVP) and often (if its not too expensive).&lt;/li&gt;
  &lt;li&gt;Cross-Entropy Loss for the binary case and extending it to multi-class examples.&lt;/li&gt;
  &lt;li&gt;Confusion matrix with &lt;code class=&quot;highlighter-rouge&quot;&gt;ClassificationInterpretation&lt;/code&gt; and looking at the &lt;code class=&quot;highlighter-rouge&quot;&gt;most_confused&lt;/code&gt; examples.&lt;/li&gt;
  &lt;li&gt;Learning Rate Finder&lt;/li&gt;
  &lt;li&gt;More particulars on transfer learning, including how to use discriminative learning rates to not lose the solid training of the transferred modeled.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;some-notes-during-reading&quot;&gt;Some Notes During Reading&lt;/h2&gt;

&lt;blockquote&gt;
  &lt;p&gt;Presizing is a particular way to do image augmentation that is designed to minimize data destruction while maintaining good performance.
The general idea is to apply a composition of the augmentation operations all at once rather than iteratively augment and interpolate. This has savings both in terms of computation and the final quality of the examples.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;In the 3s and 7s table there is a column labeled loss, which for me was a bit confusing. In the first row loss was the predicted output of the 3 class, which happened to be the correct answer. However, loss was just the output of that example, which does not quite make sense because you are looking to minimize loss which conflicts with the goal of maximizing the predicted output for the true class. It looks like this was just an oversight with the naming convention because to compute the loss more things are done and the text that follows makes this clear.&lt;/p&gt;

&lt;p&gt;I found it useful to explicitly calculate the loss in the binary example provided.&lt;/p&gt;

&lt;p&gt;Activations:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;acts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;tensor([0.6734, 0.2576])&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;class0_act&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;acts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;class1_act&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;acts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;class0_act&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;tensor(0.6734)&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Computing the exponential of the activations to then get the softmax.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;math&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;exp0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;class0_act&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;exp0&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;1.9608552547588787&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;exp1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;class1_act&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;smax0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;exp0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;exp1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;smax0&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;0.602468670578454&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;smax1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;exp1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;exp1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;smax1&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;0.39753132942154595&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;smax0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;smax1&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;1.0&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;math&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;smax0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;-0.5067196140092344&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;smax1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;-0.9224815318387478&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;smax0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;0.5067196140092344&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;And that is the loss for the first example, because the true class was 0. This matches the calculation using the fastai classes, which is always a relief.&lt;/p&gt;

&lt;h2 id=&quot;references-to-read&quot;&gt;References to Read&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://arxiv.org/abs/1506.01186&quot;&gt;Cyclical Learning Rates for Training Neural Networks&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://arxiv.org/abs/1411.1792&quot;&gt;How transferable are features in deep neural networks?&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;thoughts-on-selected-qs&quot;&gt;Thoughts on selected Qs&lt;/h2&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;Why do we first resize to a large size on the CPU, and then to a smaller size on the GPU?&lt;/p&gt;

    &lt;p&gt;You want to create a uniform input size for your data and also apply various transformations to augment it. The presizing method, running augmentation transformations as a single composition rather than iteratively, allows you to have larger/more rich inputs to transform before making them a smaller, uniform size that you will train the model with.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;What are the two ways in which data is most commonly provided, for most deep learning datasets?&lt;/p&gt;

    &lt;ol&gt;
      &lt;li&gt;A collection of data elements, that have filenames indicating information about them, like their class. (A folder of pictures where each picture has a file name with its ID and class).&lt;/li&gt;
      &lt;li&gt;Tabular format that can either contain the data in each row (along with the metadata) or point to data in other formats. (A csv file with ID, true class, and a hyper link to the input picture.)&lt;/li&gt;
    &lt;/ol&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Look up the documentation for &lt;code class=&quot;highlighter-rouge&quot;&gt;L&lt;/code&gt; and try using a few of the new methods is that it adds.&lt;/p&gt;

    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;L&lt;/code&gt; is a &lt;a href=&quot;https://fastcore.fast.ai/foundation#L&quot;&gt;beefier list class&lt;/a&gt;. How its different from a regular list:&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;the print function is smarter. It provides the length of the list and truncates the end, which is nice if youve ever crashed a server because you accidentally printed out an obscenely long list.&lt;/li&gt;
      &lt;li&gt;you can access L with a tuple, whereas a normal list will break if you try to access it that way.&lt;/li&gt;
      &lt;li&gt;it has &lt;code class=&quot;highlighter-rouge&quot;&gt;unique()&lt;/code&gt;, which functions like the same method in Pandas.&lt;/li&gt;
      &lt;li&gt;it has a filter method attribute.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Look up the documentation for the Python &lt;code class=&quot;highlighter-rouge&quot;&gt;pathlib&lt;/code&gt; module and try using a few methods of the &lt;code class=&quot;highlighter-rouge&quot;&gt;Path&lt;/code&gt; class.&lt;/p&gt;

    &lt;p&gt;&lt;a href=&quot;https://docs.python.org/3/library/pathlib.html&quot;&gt;Path&lt;/a&gt; was introduced to Python in 3.4. It appears to combine a bunch of common things that you typically use &lt;code class=&quot;highlighter-rouge&quot;&gt;os&lt;/code&gt; with along with the ability to manage file paths without doing string manipulations (as well as reducing the &lt;code class=&quot;highlighter-rouge&quot;&gt;\&lt;/code&gt; vs &lt;code class=&quot;highlighter-rouge&quot;&gt;/&lt;/code&gt; mistakes that are frequently made).&lt;/p&gt;

    &lt;p&gt;One nice thing that can be done, set &lt;code class=&quot;highlighter-rouge&quot;&gt;here = Path('.')&lt;/code&gt; and then iterate over the current directory with &lt;code class=&quot;highlighter-rouge&quot;&gt;for f in here.iterdir(): print(f)&lt;/code&gt;. You can also &lt;code class=&quot;highlighter-rouge&quot;&gt;.open()&lt;/code&gt; a path object rather than feeding it to &lt;code class=&quot;highlighter-rouge&quot;&gt;open()&lt;/code&gt; and do &lt;code class=&quot;highlighter-rouge&quot;&gt;glob&lt;/code&gt; stuff.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Give two examples of ways that image transformations can degrade the quality of the data.&lt;/p&gt;

    &lt;ol&gt;
      &lt;li&gt;Image simply rotating a square 45 degrees to stand it up on one corner. Now the new image that you get (take an old square position cut out of the rotated square position) is missing anything in the corners, so it has to be interpolated. This loses about 17% of the original image, so its pretty significant!&lt;/li&gt;
      &lt;li&gt;Brightening an image will move the brighter pixels up to the maximum brightness, so their original brightness cannot be recovered by simply redarkening.&lt;/li&gt;
    &lt;/ol&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;What method does fastai provide to view the data in a &lt;code class=&quot;highlighter-rouge&quot;&gt;DataLoaders&lt;/code&gt;?&lt;/p&gt;

    &lt;p&gt;You can use &lt;code class=&quot;highlighter-rouge&quot;&gt;.show_batch(nrows, ncols)&lt;/code&gt; on the DataLoaders object to get a grid of some of the examples.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;What method does fastai provide to help you debug a &lt;code class=&quot;highlighter-rouge&quot;&gt;DataBlock&lt;/code&gt;?&lt;/p&gt;

    &lt;p&gt;Using &lt;code class=&quot;highlighter-rouge&quot;&gt;.summary()&lt;/code&gt; on the DataBlock object gives a verbose attempt to try and create the batch. The output from this, along with errors that come up if it fails can help you notice a problem.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Should you hold off on training a model until you have thoroughly cleaned your data?&lt;/p&gt;

    &lt;p&gt;No, sometimes life is easy! Also, its good to get reasonable bench marks as soon as possible. Not only to help game-ify the problem and motivate you to work on it, but also to have a baseline to see if the room for improvement is worth the energy.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;What are the two pieces that are combined into cross-entropy loss in PyTorch?&lt;/p&gt;

    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;nn.CrossEntropyLoss&lt;/code&gt; (&lt;a href=&quot;https://pytorch.org/docs/stable/nn.html#torch.nn.CrossEntropyLoss&quot;&gt;see the docs&lt;/a&gt;) applies &lt;code class=&quot;highlighter-rouge&quot;&gt;nll_loss&lt;/code&gt; after &lt;code class=&quot;highlighter-rouge&quot;&gt;log_softmax&lt;/code&gt; (which is &lt;code class=&quot;highlighter-rouge&quot;&gt;log&lt;/code&gt; of &lt;code class=&quot;highlighter-rouge&quot;&gt;softmax&lt;/code&gt;)&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;What are the two properties of activations that softmax ensures? Why is this important?&lt;/p&gt;

    &lt;ol&gt;
      &lt;li&gt;You can interpret activations as probabilities.
        &lt;ul&gt;
          &lt;li&gt;outputs sum to one&lt;/li&gt;
          &lt;li&gt;outputs are non-negative&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;It forces the model to favor a single class.&lt;/li&gt;
    &lt;/ol&gt;

    &lt;p&gt;This more relevant behavior that is mentioned that it amplifies small differences, which is useful if you want the network to be somewhat decisive rather than having all outputs close to each other.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;When might you want your activations to not have these two properties?&lt;/p&gt;

    &lt;p&gt;The parenthetical comment in the main text mentions that you may not want the model to pick a class just because it has a slightly larger output. You want the model to be sure about the class, not just relatively sure.&lt;/p&gt;

    &lt;p&gt;For the probability property, it might be misleading because it isnt necessarily the actual probability of the example being that class.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Why cant we use &lt;code class=&quot;highlighter-rouge&quot;&gt;torch.where&lt;/code&gt; to create a loss function for datasets where our label can have more than two categories?&lt;/p&gt;

    &lt;p&gt;In part, this is a constraint of the where function. Where selects between two outputs based on a condition. It is too difficult to right a nested condition when you have more than two outcomes and selecting the loss requires a bit more work, so this trick becomes way less convenient.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;What are two good rules of thumb for picking a learning rate from the learning rate finder?&lt;/p&gt;

    &lt;blockquote&gt;
      &lt;ul&gt;
        &lt;li&gt;One order of magnitude less than where the minimum loss was achieved (i.e., the minimum divided by 10).&lt;/li&gt;
        &lt;li&gt;The last point where the loss was clearly decreasing&lt;/li&gt;
      &lt;/ul&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;What two steps does the &lt;code class=&quot;highlighter-rouge&quot;&gt;fine_tune&lt;/code&gt; method do?&lt;/p&gt;

    &lt;p&gt;We go to the &lt;a href=&quot;https://github.com/fastai/fastai2/blob/master/fastai2/callback/schedule.py#L141&quot;&gt;source&lt;/a&gt;:&lt;/p&gt;

    &lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;freeze&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit_one_cycle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;freeze_epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;slice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;base_lr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pct_start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.99&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kwargs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;base_lr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unfreeze&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit_one_cycle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;slice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;base_lr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lr_mult&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;base_lr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pct_start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pct_start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kwargs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Thus it:
    1. Performs a one-cycle fit with the pre-trained layers frozen (their weights do not update).
    2. Performs another one-cycle fit with the pre-trained layers unfrozen at half the learning rate.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;What are discriminative learning rates?&lt;/p&gt;

    &lt;p&gt;The idea here is that you may want weights in certain layers to change at a different rate. In particular, if your first layers come from a pretrained network you may want to do updates to them more slowly than the last layers which are tailored to your particular problem.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;How is a Python &lt;code class=&quot;highlighter-rouge&quot;&gt;slice&lt;/code&gt; object interpreted when passed as a learning rate to fastai?&lt;/p&gt;

    &lt;p&gt;It acts like &lt;code class=&quot;highlighter-rouge&quot;&gt;numpy.linspace&lt;/code&gt; where the &lt;code class=&quot;highlighter-rouge&quot;&gt;num&lt;/code&gt; is implicitly defined as the number of layers.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Why is early stopping a poor choice when using 1cycle training?&lt;/p&gt;

    &lt;p&gt;For a description of 1cycle training, the &lt;a href=&quot;https://docs.fast.ai/callbacks.one_cycle.html&quot;&gt;fastai docs&lt;/a&gt; refer to the rate finder paper in the references as well as &lt;a href=&quot;https://sgugger.github.io/the-1cycle-policy.html&quot;&gt;this blog post&lt;/a&gt;. It looks like the basic idea is stopping early does give the training a chance to be finely tuned, because you are likely stopping at a point where the learning rate is still large.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;What is the difference between &lt;code class=&quot;highlighter-rouge&quot;&gt;resnet50&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;resnet101&lt;/code&gt;?&lt;/p&gt;

    &lt;p&gt;Both &lt;code class=&quot;highlighter-rouge&quot;&gt;resnet50&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;resnet100&lt;/code&gt; are residual networks, and seem to have been introduced in &lt;a href=&quot;https://arxiv.org/pdf/1512.03385.pdf&quot;&gt;Deep Residual Learning for Image Recognition&lt;/a&gt;. The basic idea of deep residual networks seems to be wire a network that is trying to learn the function $\mathcal{H}(x)$ such that it has to learn $\mathcal{H}(x) - x$ instead. The intuition being that, for example, it is easier to learn the zero function than it is to learn the identity function. &lt;code class=&quot;highlighter-rouge&quot;&gt;resnet-50&lt;/code&gt; looks like it was obtain from the &lt;code class=&quot;highlighter-rouge&quot;&gt;resnet-34&lt;/code&gt; architecture by replacing certain layer pairs with layer triplets known as bottleneck blocks. &lt;code class=&quot;highlighter-rouge&quot;&gt;resnet-101&lt;/code&gt; (and &lt;code class=&quot;highlighter-rouge&quot;&gt;resnet-152&lt;/code&gt;) are just an expansion of this idea, adding 17 more (or 34 more) of these triplet-layer blocks.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;What does &lt;code class=&quot;highlighter-rouge&quot;&gt;to_fp16&lt;/code&gt; do?&lt;/p&gt;

    &lt;blockquote&gt;
      &lt;p&gt;The other downside of deeper architectures is that they take quite a bit longer to train. One technique that can speed things up a lot is mixed-precision training. This refers to using less-precise numbers (half-precision floating point, also called fp16) where possible during training. As we are writing these words in early 2020, nearly all current NVIDIA GPUs support a special feature called tensor cores that can dramatically speed up neural network training, by 2-3x. They also require a lot less GPU memory. To enable this feature in fastai, just add to_fp16() after your Learner creation (you also need to import the module).&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ol&gt;</content><author><name></name></author><summary type="html">FastBook Chapter 5 Thoughts</summary></entry><entry><title type="html">Solving a Nightmare with a Headache</title><link href="http://simonstolarczyk.com/markdown/2020/07/12/wind_nightmare.html" rel="alternate" type="text/html" title="Solving a Nightmare with a Headache" /><published>2020-07-12T00:00:00-05:00</published><updated>2020-07-12T00:00:00-05:00</updated><id>http://simonstolarczyk.com/markdown/2020/07/12/wind_nightmare</id><content type="html" xml:base="http://simonstolarczyk.com/markdown/2020/07/12/wind_nightmare.html">&lt;h1 id=&quot;solving-a-nightmare-with-a-headache&quot;&gt;Solving a Nightmare with a Headache&lt;/h1&gt;

&lt;p&gt;&lt;strong&gt;Issue&lt;/strong&gt;: The widgets in Jupyter Notebook were not all displaying.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Non-solution&lt;/strong&gt;: Try re-do some installs in the virtualenv. While I am at it, lets also try out pyenv.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;New Issue&lt;/strong&gt;: Windows does not play well with pyenv. You can get pyenv to work, but then virtualenv is no longer set up on your global environment.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Attempted Solution&lt;/strong&gt;: Try to clone the pyenv-virtualenv repo into a new plugins directory of the pyenv root folder. This did not work, despite sinking about an hour into this whole mess.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;New Issue&lt;/strong&gt;: Its time to put Linux on my machine to try and escape some of these Windows nightmares. This is going to be a headache, but it seems like the pay off will be worth-while, given that the Fastbook also doesnt play well with Windows. I have been frustrated with doing Python things on Windows before so I had Linux available already. I will note that it took be a while to remember I already had a Linux partition and in a cascading wave of failure, I forgot my linux password, so was not able to run a needed sudo command. But, I got lucky again (and this is a yikes security-wise) and it turns out you can easily reset the password for Ubuntu.&lt;/p&gt;

&lt;p&gt;From here I followed &lt;a href=&quot;https://realpython.com/intro-to-pyenv/#virtual-environments-and-pyenv&quot;&gt;Real Pythons primer on pyenv&lt;/a&gt;. Setting this up was not bad and putting some lines in .bashrc virtualenv becomes much nicer to use. It allows you connect a particular environment to a folder. I created a virtualenv named &lt;code class=&quot;highlighter-rouge&quot;&gt;fab&lt;/code&gt; (FastAI Book, short environment names are good when youre used to activating an environment every time you want to work on something) by again &lt;a href=&quot;https://realpython.com/python-virtual-environments-a-primer/&quot;&gt;following Real Python&lt;/a&gt; and now it is automatically activated when I am in the fastbook directory. A quick &lt;code class=&quot;highlighter-rouge&quot;&gt;pip install -r requirements.txt -v&lt;/code&gt; got the environment running smoothly with the notebook for Chapter 1, and things that did not work 100% in Windows worked in my Linux boot nicely (at least after a &lt;code class=&quot;highlighter-rouge&quot;&gt;sudo apt install graphviz&lt;/code&gt;):&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;I could run the cells without having to change &lt;code class=&quot;highlighter-rouge&quot;&gt;num_workers&lt;/code&gt; to 0.&lt;/li&gt;
  &lt;li&gt;My GPU was visible to Torch (&lt;code class=&quot;highlighter-rouge&quot;&gt;torch.cuda.get_device_name(0)&lt;/code&gt; returned the name of my GPU).&lt;/li&gt;
  &lt;li&gt;The text example, which did not work at all on Windows, ran.&lt;/li&gt;
  &lt;li&gt;And, the whole reason I started this endeavor: when I created the &lt;code class=&quot;highlighter-rouge&quot;&gt;FileUploader&lt;/code&gt; widget, it appeared in the notebook.&lt;/li&gt;
&lt;/ul&gt;</content><author><name></name></author><summary type="html">Solving a Nightmare with a Headache</summary></entry><entry><title type="html">FastAI Book Chapter 2</title><link href="http://simonstolarczyk.com/markdown/2020/07/11/fastai_book_ch2.html" rel="alternate" type="text/html" title="FastAI Book Chapter 2" /><published>2020-07-11T00:00:00-05:00</published><updated>2020-07-11T00:00:00-05:00</updated><id>http://simonstolarczyk.com/markdown/2020/07/11/fastai_book_ch2</id><content type="html" xml:base="http://simonstolarczyk.com/markdown/2020/07/11/fastai_book_ch2.html">&lt;h1 id=&quot;fastai-book-chapter-2&quot;&gt;FastAI Book Chapter 2&lt;/h1&gt;
&lt;p&gt;I went through the second chapter of the book today, which is why this blog even exists.
Highly useful; looking forward to working on some music projects to really learn the material.&lt;/p&gt;

&lt;h2 id=&quot;things-i-learned&quot;&gt;Things I Learned&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;How to easily build an image classifier to discern between blue jays, mockingbirds, and shrikes.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;I chose the first two bird types based on my familiarity and their Cool Local Bird ranks. I was going to select a cardinal as a third class, but thought it would be too easy to detect the class based solely on color, so I searched around and found shrikes, which looked similar to mockingbirds. The classifier performed very well, which was I semi-shock because I didnt know:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;You do not always need a lot of data to build a decent model.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Even with 150 examples of each of three classes (before train/validation split), there were only 3 misclassifications on the validation set. This shows how powerful data augmentation can be, but also helps dispel the notion that you need tons of data to do anything reasonable.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;FastAI has some powerful tools that I need to learn.&lt;/li&gt;
&lt;/ul&gt;

&lt;ol&gt;
  &lt;li&gt;Easily display the examples with the highest loss and lowest confidence to see if I can interpret possible deficiencies with &lt;code class=&quot;highlighter-rouge&quot;&gt;interp.plot_top_losses()&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;Clean up the dataset with &lt;code class=&quot;highlighter-rouge&quot;&gt;ImageClassifierCleaner&lt;/code&gt;, manually going through some of the examples to change labels or remove them, and then effect the changes with a couple simple for-loops.&lt;/li&gt;
  &lt;li&gt;Use &lt;code class=&quot;highlighter-rouge&quot;&gt;verify_images&lt;/code&gt; to clean up corrupted files easily.&lt;/li&gt;
  &lt;li&gt;Use &lt;code class=&quot;highlighter-rouge&quot;&gt;DataBlock&lt;/code&gt; to define the structure of the problem and implement useful transformations for the data.&lt;/li&gt;
&lt;/ol&gt;

&lt;ul&gt;
  &lt;li&gt;Think about how to normalize images.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Squashing a large image into a smaller one with simple scaling or adding cropped parts of small images is maybe not the best way to make sure the inputs are all from the same distribution. You can use &lt;code class=&quot;highlighter-rouge&quot;&gt;RandomResizedCrop&lt;/code&gt; to maintain original image quality and also artificially expand the size of your training set.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Other things:
    &lt;ul&gt;
      &lt;li&gt;How to easily build a dataset with the Bing Image API.&lt;/li&gt;
      &lt;li&gt;The usefulness of Path (which I only recently learned about) was really demonstrated nicely.&lt;/li&gt;
      &lt;li&gt;The Drivetrain Approach.&lt;/li&gt;
      &lt;li&gt;Creating a Notebook App with widgets and Voil. (Admittedly, Im still trying to get the latter to work.)&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;things-i-had-to-troubleshoot&quot;&gt;Things I Had to Troubleshoot&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;How do you find the Bing Image Search key?&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Solution: I signed up for the free Azure thing, went to to the &lt;a href=&quot;https://azure.microsoft.com/en-us/services/cognitive-services/bing-image-search-api/&quot;&gt;Bing Image Search API&lt;/a&gt;, and just had to click to add Bing Search APIs v7 to my subscription. Once I did this it brought up a page with the keys and endpoints.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;I am using my local computer, with Windows, to run the notebooks. So, I have run into (standard) issues. Namely, I saw &lt;code class=&quot;highlighter-rouge&quot;&gt;RuntimeError: cuda runtime error (801) : operation not supported at...&lt;/code&gt; when I first attempted to fine tune the learner &lt;code class=&quot;highlighter-rouge&quot;&gt;learn.fine_tune(4)&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Solution: When you google the error &lt;a href=&quot;https://github.com/fastai/fastbook/issues/85&quot;&gt;this issue page&lt;/a&gt; points you to the forum, but also usefully mentions the need to set num_workers=0 when creating a DataLoaders because Pytorch multiprocessing does not work on Windows. So, doing this when you define the dataloaders &lt;code class=&quot;highlighter-rouge&quot;&gt;dls = bears.dataloaders(path, num_workers=0)&lt;/code&gt; cleared it up for me.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Some minor formatting issues with &lt;code class=&quot;highlighter-rouge&quot;&gt;interp.plot_top_losses(5, nrows=1)&lt;/code&gt;. The text above the images was overlapping, because my class names were a bit long.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Simple fix was to set &lt;code class=&quot;highlighter-rouge&quot;&gt;nrows=5&lt;/code&gt;.&lt;/p&gt;</content><author><name></name></author><summary type="html">FastAI Book Chapter 2 I went through the second chapter of the book today, which is why this blog even exists. Highly useful; looking forward to working on some music projects to really learn the material.</summary></entry></feed>